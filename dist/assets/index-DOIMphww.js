import{j as e,B as x,S as He,r as j}from"./index-dVfrCOv9.js";import{C as Ee}from"./config-drawer-CWBKy2WQ.js";import{H as ze,S as $e}from"./search-7kGhzZ1w.js";import{M as Be}from"./main-DEegZPWV.js";import{P as Re}from"./profile-dropdown-bG5jcavA.js";import{T as Ue}from"./theme-switch-BegLrGiy.js";import{T as We,a as _e,b as ge,c as je}from"./tabs-_HOMcj1t.js";import{S as Ke,a as qe,b as Ge,c as Je,d as Xe}from"./select-D9f37jTv.js";import{C as h,a as f,b as p,c as u,d as ee}from"./card-CcyQ8NyC.js";import{B as N}from"./badge-BptwIr8q.js";import{B as Ne,a as K,E as Ye,F as Qe,G as Ze,H as es,I as ss,D as Te,g as Ie,h as Le,k as H,j as oe,C as xe}from"./confirm-dialog-Be-bjMHP.js";import{T as Y}from"./triangle-alert-CZIIm677.js";import{C as ae}from"./clock-18a-uOXj.js";import{C as R}from"./circle-check-big-C7TXVof4.js";import{T as ve}from"./trending-up-kXXgp-Pw.js";import{C as U,L as be,a as se,G as ts}from"./LineChart-Bzf38JkE.js";import{A as as}from"./activity-DUB57z-1.js";import{R as ye,C as we,X as Se,Y as ke,T as Ce}from"./CartesianChart-DBFc46iT.js";import{L as De,F as Fe,E as Pe,C as me}from"./Legend-D8xKVIjM.js";import{X as re,T as te}from"./scroll-area-BeseHV4g.js";import{E as Ve}from"./external-link-e8PiQa8J.js";import{C as Q}from"./calendar-DOpOIbcs.js";import{C as q}from"./circle-alert-7jZLMqfe.js";import{E as pe}from"./eye--F3oNh1v.js";import{B as rs}from"./building-2-DVNCVtAT.js";import{C as is}from"./chart-column-BkXu6-Cn.js";import"./index-B0DUAfYy.js";import"./index-iKOy4lqH.js";import"./index-NZ7H_o-Z.js";import"./index-a_CoEgfN.js";import"./index-Db5gyEo-.js";import"./index-GZjvmeDg.js";import"./index-CaA_8StY.js";import"./layout-provider-DxlwojsR.js";import"./rotate-ccw-Bhwq1CUx.js";import"./circle-check-DbAEh7Iq.js";import"./separator-ByCjNU3E.js";import"./sign-out-dialog-BvwecN2-.js";import"./check-DmtuAz6s.js";import"./index-B9a07b_S.js";import"./index-lu-C_CL2.js";import"./index-Be1aPicm.js";import"./circle-question-mark-CFS9fkn6.js";import"./arrow-right-09iS3hhb.js";function ls({stats:a}){const c=a.total>0?a.fixed/a.total*100:0,v=a.total>0?a.overdue/a.total*100:0,V=[{month:"Last 30 Days",sca:15,sast:12,dast:8,total:35}],z=[{month:"Last 30 Days",critical:8,high:14,medium:18,low:6,total:46}],w=[{date:"Dec 29",avgScore:7.2},{date:"Jan 5",avgScore:6.8},{date:"Jan 12",avgScore:6.5},{date:"Jan 19",avgScore:6.2},{date:"Jan 26",avgScore:5.9}],g=[{date:"Dec 29",critical:12,high:25,medium:18,low:8},{date:"Jan 5",critical:10,high:22,medium:20,low:10},{date:"Jan 12",critical:8,high:20,medium:22,low:12},{date:"Jan 19",critical:11,high:24,medium:19,low:9},{date:"Jan 26",critical:9,high:21,medium:21,low:11}],o=[{id:"VULN-0042",title:"Remote Code Execution in API Gateway",severity:"Critical",asset:"Axion API Gateway",cvssScore:9.8,riskScore:98,category:"appsec"},{id:"VULN-0038",title:"SQL Injection in User Database",severity:"Critical",asset:"Customer Database Server",cvssScore:9.5,riskScore:95,category:"appsec"},{id:"VULN-0051",title:"Privilege Escalation in Admin Panel",severity:"Critical",asset:"Admin Dashboard",cvssScore:9.2,riskScore:92,category:"appsec"},{id:"VULN-0067",title:"Buffer Overflow in Web Service",severity:"Critical",asset:"Web Application Frontend",cvssScore:9.7,riskScore:97,category:"offsec"},{id:"VULN-0072",title:"Authentication Bypass in API",severity:"Critical",asset:"API Gateway",cvssScore:9.9,riskScore:99,category:"offsec"},{id:"VULN-0089",title:"Directory Traversal in File System",severity:"Critical",asset:"Content Server",cvssScore:9.3,riskScore:93,category:"offsec"}],d=({active:i,payload:b})=>i&&b&&b.length?e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 shadow-lg",children:[e.jsx("p",{className:"font-semibold text-sm",children:b[0].payload.date}),b.map((A,S)=>e.jsxs("p",{style:{color:A.color},className:"text-xs",children:[A.name,": ",A.value]},S))]}):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-blue-600"}),"Total Vulnerabilities"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold",children:a.total}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Across all projects and sources"})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-red-600"}),"Critical & High"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:a.critical+a.high}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Critical: ",a.critical,", High: ",a.high]})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-orange-600"}),"Overdue"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:a.overdue}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[v.toFixed(1),"% of total"]})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-green-600"}),"Fixed"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:a.fixed}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[c.toFixed(1),"% completion rate"]})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-purple-600"}),"Avg CVSS Score"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold",children:a.avgCvss}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["MTTR: ",a.mttr," days"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-blue-600"}),"AppSec Vulnerability Trends"]}),e.jsx(ee,{children:"Vulnerabilities discovered by source in last 30 days"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-3",children:V.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("div",{className:"font-medium text-sm w-20",children:i.month}),e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),e.jsxs("span",{className:"text-sm",children:["SCA: ",i.sca]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsxs("span",{className:"text-sm",children:["SAST: ",i.sast]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-indigo-500"}),e.jsxs("span",{className:"text-sm",children:["DAST: ",i.dast]})]})]}),e.jsxs("div",{className:"text-sm font-medium",children:["Total: ",e.jsx("span",{className:"text-blue-600",children:i.total})]})]},i.month))})})]}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-red-600"}),"OffSec Vulnerability Trends"]}),e.jsx(ee,{children:"Vulnerabilities discovered by severity in last 30 days"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-3",children:z.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("div",{className:"font-medium text-sm w-20",children:i.month}),e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsxs("span",{className:"text-sm",children:["Critical: ",i.critical]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"}),e.jsxs("span",{className:"text-sm",children:["High: ",i.high]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),e.jsxs("span",{className:"text-sm",children:["Medium: ",i.medium]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm",children:["Low: ",i.low]})]})]}),e.jsxs("div",{className:"text-sm font-medium",children:["Total: ",e.jsx("span",{className:"text-red-600",children:i.total})]})]},i.month))})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(as,{className:"h-5 w-5 text-orange-600"}),"CVSS Score Trend"]}),e.jsx(ee,{children:"Average CVSS score for past 30 days"})]}),e.jsx(u,{children:e.jsx(ye,{width:"100%",height:300,children:e.jsxs(be,{data:w,children:[e.jsx(we,{strokeDasharray:"3 3"}),e.jsx(Se,{dataKey:"date"}),e.jsx(ke,{domain:[0,10]}),e.jsx(Ce,{content:e.jsx(d,{})}),e.jsx(De,{}),e.jsx(se,{type:"monotone",dataKey:"avgScore",stroke:"#f97316",strokeWidth:2,name:"Avg CVSS Score",dot:{fill:"#f97316",r:4}}),e.jsx(se,{type:"monotone",dataKey:()=>7,stroke:"#dc2626",strokeWidth:2,strokeDasharray:"5 5",name:"High Risk Threshold",dot:!1})]})})})]}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5 text-purple-600"}),"Overall Vulnerability Trends"]}),e.jsx(ee,{children:"Vulnerability trends for past 30 days"})]}),e.jsx(u,{children:e.jsx(ye,{width:"100%",height:300,children:e.jsxs(be,{data:g,children:[e.jsx(we,{strokeDasharray:"3 3"}),e.jsx(Se,{dataKey:"date"}),e.jsx(ke,{}),e.jsx(Ce,{}),e.jsx(De,{}),e.jsx(se,{type:"monotone",dataKey:"critical",stroke:"#dc2626",strokeWidth:2,name:"Critical"}),e.jsx(se,{type:"monotone",dataKey:"high",stroke:"#ea580c",strokeWidth:2,name:"High"}),e.jsx(se,{type:"monotone",dataKey:"medium",stroke:"#ca8a04",strokeWidth:2,name:"Medium"}),e.jsx(se,{type:"monotone",dataKey:"low",stroke:"#16a34a",strokeWidth:2,name:"Low"})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-red-600"}),"AppSec Top Critical"]}),e.jsx(ee,{children:"Most critical AppSec vulnerabilities requiring immediate attention"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-4",children:o.filter(i=>i.category==="appsec").map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(U,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-mono text-muted-foreground",children:i.id}),e.jsx(N,{variant:"destructive",className:"text-xs",children:i.severity}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["CVSS: ",i.cvssScore]})]}),e.jsx("h4",{className:"text-sm font-medium mb-1",children:i.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i.asset})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-sm font-medium text-red-600",children:["Risk Score: ",i.riskScore]})})]},i.id))})})]}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-red-600"}),"OffSec Top Critical"]}),e.jsx(ee,{children:"Most critical OffSec vulnerabilities requiring immediate attention"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-4",children:o.filter(i=>i.category==="offsec").map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(K,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-xs font-mono text-muted-foreground",children:i.id}),e.jsx(N,{variant:"destructive",className:"text-xs",children:i.severity}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["CVSS: ",i.cvssScore]})]}),e.jsx("h4",{className:"text-sm font-medium mb-1",children:i.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i.asset})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-sm font-medium text-red-600",children:["Risk Score: ",i.riskScore]})})]},i.id))})})]})]})]})}function Oe({vulnerability:a,open:c,onOpenChange:v}){if(!a)return null;const V=d=>{switch(d){case"Critical":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"High":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200";case"Medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"Low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},z=d=>{switch(d){case"Fixed":return e.jsx(R,{className:"h-4 w-4 text-green-600"});case"In Progress":return e.jsx(ae,{className:"h-4 w-4 text-blue-600"});case"Open":return e.jsx(Y,{className:"h-4 w-4 text-orange-600"});case"Accepted":return e.jsx(q,{className:"h-4 w-4 text-yellow-600"});case"False Positive":return e.jsx(re,{className:"h-4 w-4 text-gray-600"});default:return e.jsx(Y,{className:"h-4 w-4 text-orange-600"})}},w=d=>{switch(d){case"appsec":return e.jsx(U,{className:"h-5 w-5 text-blue-600"});case"offsec":return e.jsx(K,{className:"h-5 w-5 text-red-600"});default:return e.jsx(He,{className:"h-5 w-5 text-gray-600"})}},g=d=>d>=9?"text-red-600 bg-red-50":d>=7?"text-orange-600 bg-orange-50":d>=4?"text-yellow-600 bg-yellow-50":"text-green-600 bg-green-50",o=new Date(a.dueDate)<new Date&&a.status!=="Fixed";return e.jsx(Ye,{open:c,onOpenChange:v,children:e.jsxs(Qe,{className:"w-screen max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[w(a.category),e.jsx(es,{className:"text-xl",children:a.title})]}),e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>v(!1),className:"rounded-full hover:bg-muted/80",children:e.jsx(re,{className:"h-5 w-5"})})]}),e.jsx(ss,{className:"text-base",children:a.description})]}),e.jsxs("div",{className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Vulnerability ID"}),e.jsx("div",{className:"font-mono text-sm",children:a.key})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Severity"}),e.jsx(N,{className:V(a.severity),children:a.severity})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"CVSS Score"}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-md text-sm font-medium ${g(a.cvssScore)}`,children:a.cvssScore})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[z(a.status),e.jsx("span",{className:"text-sm",children:a.status})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Asset Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Asset"}),e.jsx("span",{className:"text-sm font-medium",children:a.asset})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Asset Type"}),e.jsx("span",{className:"text-sm font-medium",children:a.assetType})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Project"}),e.jsx("span",{className:"text-sm font-medium",children:a.project})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Affected Component"}),e.jsx("span",{className:"text-sm font-medium",children:a.affectedComponent})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Source Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Source"}),e.jsx("span",{className:"text-sm font-medium",children:a.sourceLabel})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Category"}),e.jsxs("div",{className:"flex items-center gap-2",children:[w(a.category),e.jsx("span",{className:"text-sm font-medium capitalize",children:a.category})]})]}),a.cveId&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"CVE ID"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:a.cveId}),e.jsx(x,{size:"sm",variant:"outline",className:"h-6 px-2",onClick:()=>window.open(`https://cve.mitre.org/cgi-bin/cvename.cgi?name=${a.cveId}`,"_blank"),children:e.jsx(Ve,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Risk Score"}),e.jsxs("span",{className:"text-sm font-medium",children:[a.riskScore,"/100"]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Created Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:new Date(a.createdDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Due Date"}),e.jsxs("div",{className:`flex items-center gap-2 ${o?"text-red-600":""}`,children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:new Date(a.dueDate).toLocaleDateString()}),o&&e.jsx("span",{className:"text-xs text-red-600",children:"(Overdue)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:new Date(a.updatedDate).toLocaleDateString()})]})]})]})]}),a.assignee&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Assignee"}),e.jsx("div",{className:"text-sm",children:a.assignee})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Remediation"}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm",children:a.remediation})})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map((d,i)=>e.jsx(N,{variant:"secondary",className:"text-xs",children:d},i))})]}),a.references&&a.references.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"References"}),e.jsx("div",{className:"space-y-2",children:a.references.map((d,i)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:d})]},i))})]})]})]})})}function cs({vulnerabilities:a}){const c=a.filter(s=>s.category==="appsec"),[v,V]=j.useState(null),[z,w]=j.useState(!1),[g,o]=j.useState([]),[d,i]=j.useState("severity"),[b,A]=j.useState("desc"),[S,$]=j.useState("all"),[y,W]=j.useState("all"),[n,F]=j.useState("all"),[k,M]=j.useState("list"),[C,P]=j.useState(1),[ie,_]=j.useState(new Date().toISOString()),[ne,he]=j.useState(null),G=10,T={total:c.length,critical:c.filter(s=>s.severity==="Critical").length,high:c.filter(s=>s.severity==="High").length,medium:c.filter(s=>s.severity==="Medium").length,low:c.filter(s=>s.severity==="Low").length,open:c.filter(s=>s.status==="Open").length,inProgress:c.filter(s=>s.status==="In Progress").length,fixed:c.filter(s=>s.status==="Fixed").length,overdue:c.filter(s=>s.status==="Fixed"||s.status==="Accepted"||s.status==="False Positive"?!1:new Date(s.dueDate)<new Date).length,avgCvss:c.reduce((s,r)=>s+r.cvssScore,0)/c.length||0},le=s=>{switch(s){case"Critical":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"High":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200";case"Medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"Low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},ue=s=>{switch(s){case"Fixed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"In Progress":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"Open":return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},J=s=>{switch(s){case"Fixed":return e.jsx(R,{className:"h-4 w-4"});case"In Progress":return e.jsx(ae,{className:"h-4 w-4"});case"Open":return e.jsx(te,{className:"h-4 w-4"});case"Accepted":return e.jsx(q,{className:"h-4 w-4"});case"False Positive":return e.jsx(re,{className:"h-4 w-4"});default:return e.jsx(te,{className:"h-4 w-4"})}},B=s=>{switch(s){case"Critical":return 4;case"High":return 3;case"Medium":return 2;case"Low":return 1;default:return 0}},O=(s,r)=>{switch(s){case"severity":$(r);break;case"status":W(r);break;case"source":F(r);break}P(1)},I=s=>{V(s),w(!0)},Z=(s,r)=>{o(r?D=>[...D,s]:D=>D.filter(E=>E!==s))},X=s=>{o(s?ce.map(r=>r.id):[])},t=s=>{console.log(`Bulk action: ${s} on vulnerabilities:`,g)},l=(s,r)=>{switch(console.log(`Action: ${s} on vulnerability:`,r.id),s){case"view":I(r);break;case"edit":console.log("Edit vulnerability:",r.id);break;case"assign":console.log("Assign vulnerability:",r.id);break;case"create-ticket":console.log("Create ticket for vulnerability:",r.id);break;case"export":console.log("Export vulnerability:",r.id);break;case"mark-fixed":console.log("Mark vulnerability as fixed:",r.id);break;case"delete":console.log("Delete vulnerability:",r.id);break;default:console.log("Unknown action:",s)}},m=c.filter(s=>S==="all"||s.severity===S).filter(s=>y==="all"||s.status===y).filter(s=>n==="all"||s.source===n).sort((s,r)=>{let D,E;switch(d){case"severity":D=B(s.severity),E=B(r.severity);break;case"cvssScore":D=s.cvssScore,E=r.cvssScore;break;case"status":D=s.status,E=r.status;break;case"createdDate":D=new Date(s.createdDate).getTime(),E=new Date(r.createdDate).getTime();break;case"dueDate":D=new Date(s.dueDate).getTime(),E=new Date(r.dueDate).getTime();break;default:D=s.severity,E=r.severity}return b==="asc"?D>E?1:-1:D<E?1:-1}),L=Math.ceil(m.length/G),de=(C-1)*G,ce=m.slice(de,de+G);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-blue-600"}),"Total Vulnerabilities"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold",children:T.total}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"AppSec vulnerabilities (open + fixed)"})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-red-600"}),"Critical"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:T.critical}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Requires immediate attention"})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-orange-600"}),"Overdue"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:T.overdue}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Past due date"})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-green-600"}),"Fixed"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:T.fixed}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Successfully remediated"})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-purple-600"}),"Avg CVSS Score"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold",children:T.avgCvss.toFixed(1)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Risk severity average"})]})]})]}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"AppSec Vulnerabilities",e.jsxs(N,{variant:"outline",children:[m.length," items"]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("select",{value:S,onChange:s=>O("severity",s.target.value),className:"px-3 py-1 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Severity"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),e.jsxs("select",{value:y,onChange:s=>O("status",s.target.value),className:"px-3 py-1 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"Open",children:"Open"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Fixed",children:"Fixed"})]}),e.jsxs("select",{value:n,onChange:s=>O("source",s.target.value),className:"px-3 py-1 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Sources"}),e.jsx("option",{value:"snyk_sca",children:"SCA"}),e.jsx("option",{value:"snyk_sast",children:"SAST"}),e.jsx("option",{value:"snyk_dast",children:"DAST"})]}),e.jsxs("select",{value:`${d}-${b}`,onChange:s=>{const[r,D]=s.target.value.split("-");i(r),A(D)},className:"px-3 py-1 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"severity-desc",children:"Severity (High to Low)"}),e.jsx("option",{value:"severity-asc",children:"Severity (Low to High)"}),e.jsx("option",{value:"cvssScore-desc",children:"CVSS Score (High to Low)"}),e.jsx("option",{value:"cvssScore-asc",children:"CVSS Score (Low to High)"}),e.jsx("option",{value:"createdDate-desc",children:"Created Date (Newest)"}),e.jsx("option",{value:"createdDate-asc",children:"Created Date (Oldest)"}),e.jsx("option",{value:"dueDate-desc",children:"Due Date (Nearest)"}),e.jsx("option",{value:"dueDate-asc",children:"Due Date (Farthest)"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[e.jsx(x,{size:"sm",variant:k==="list"?"default":"outline",onClick:()=>M("list"),children:"List"}),e.jsx(x,{size:"sm",variant:k==="board"?"default":"outline",onClick:()=>M("board"),children:"Board"}),e.jsx(x,{size:"sm",variant:k==="timeline"?"default":"outline",onClick:()=>M("timeline"),children:"Timeline"})]})]})]}),e.jsxs(u,{children:[k==="list"&&e.jsxs("div",{className:"space-y-4",children:[g.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:[g.length," vulnerability",g.length>1?"s":""," selected"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{size:"sm",variant:"outline",onClick:()=>t("create-ticket"),children:"Create Ticket"}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>t("export"),children:"Export"}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>t("assign"),children:"Assign"}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>t("mark-fixed"),children:"Mark as Fixed"}),e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>o([]),children:"Clear Selection"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/30",children:[e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[5%]",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300",checked:g.length===ce.length&&ce.length>0,onChange:s=>X(s.target.checked)})}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[15%]",children:"ID"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[28%]",children:"Title"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[10%]",children:"Severity"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[8%]",children:"CVSS"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[12%]",children:"Status"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[12%]",children:"Scan Type"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[10%]",children:"Date Found"}),e.jsx("th",{className:"text-center p-3 font-medium text-sm text-muted-foreground w-[10%]",children:"Actions"})]})}),e.jsx("tbody",{children:ce.map(s=>e.jsxs("tr",{className:"border-b hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300",checked:g.includes(s.id),onChange:r=>Z(s.id,r.target.checked)})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>I(s),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-muted-foreground font-mono",children:s.key})]})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>I(s),children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-medium text-sm hover:text-blue-600 transition-colors",children:s.title}),s.cveId&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.cveId})]})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>I(s),children:e.jsx(N,{className:le(s.severity),children:s.severity})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>I(s),children:e.jsx("span",{className:"text-sm font-medium",children:s.cvssScore})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>I(s),children:e.jsx(N,{className:ue(s.status),children:s.status})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>I(s),children:e.jsx("div",{className:"text-sm",children:s.sourceLabel})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>I(s),children:e.jsx("div",{className:"text-sm",children:new Date(s.createdDate).toLocaleDateString()})}),e.jsx("td",{className:"p-3 text-center",children:e.jsxs(Te,{children:[e.jsx(Ie,{asChild:!0,children:e.jsx(x,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsxs(Le,{align:"end",children:[e.jsxs(H,{onClick:()=>l("view",s),children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.jsxs(H,{onClick:()=>l("edit",s),children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(H,{onClick:()=>l("assign",s),children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Assign"]}),e.jsx(oe,{}),e.jsxs(H,{onClick:()=>l("create-ticket",s),children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Create Ticket"]}),e.jsxs(H,{onClick:()=>l("export",s),children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Export"]}),e.jsx(oe,{}),e.jsxs(H,{onClick:()=>l("mark-fixed",s),children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Mark as Fixed"]}),e.jsxs(H,{onClick:()=>l("delete",s),className:"text-red-600",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},s.id))})]})}),L>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",de+1," to ",Math.min(de+G,m.length)," of ",m.length," vulnerabilities"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>P(s=>Math.max(s-1,1)),disabled:C===1,children:[e.jsx(me,{className:"h-4 w-4"}),"Previous"]}),e.jsxs("span",{className:"text-sm",children:["Page ",C," of ",L]}),e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>P(s=>Math.min(s+1,L)),disabled:C===L,children:["Next",e.jsx(xe,{className:"h-4 w-4"})]})]})]}),ce.length===0&&m.length>0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(U,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No vulnerabilities on this page"}),e.jsx("p",{className:"text-sm",children:"Try changing filters or going to a different page"})]}),m.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(U,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No AppSec vulnerabilities found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters"})]})]}),k==="board"&&e.jsx("div",{className:"space-y-6",children:[{severity:"Critical",color:"bg-red-500",filter:s=>s.severity==="Critical"},{severity:"High",color:"bg-orange-500",filter:s=>s.severity==="High"},{severity:"Medium",color:"bg-yellow-500",filter:s=>s.severity==="Medium"},{severity:"Low",color:"bg-green-500",filter:s=>s.severity==="Low"}].map(s=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-muted/50 to-muted/30 rounded-lg border border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s.color}`}),e.jsx("h3",{className:"font-semibold text-sm",children:s.severity})]}),e.jsx(N,{variant:"secondary",className:"font-medium",children:m.filter(s.filter).length})]}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"outline",size:"sm",className:"flex-shrink-0",onClick:()=>{const r=document.getElementById(`scroll-container-${s.severity}`);r&&r.scrollBy({left:-300,behavior:"smooth"})},children:e.jsx(me,{className:"h-4 w-4"})}),e.jsxs("div",{id:`scroll-container-${s.severity}`,className:"flex gap-3 overflow-x-auto scrollbar-hide scroll-smooth p-1 bg-gradient-to-b from-background to-muted/20 rounded-xl border border-muted-foreground/20",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[m.filter(s.filter).map(r=>e.jsx(h,{className:"group cursor-pointer hover:shadow-lg hover:scale-[1.02] transition-all duration-200 border-border/50 bg-gradient-to-br from-card to-card/80 flex-shrink-0 w-80",onClick:()=>I(r),children:e.jsxs(u,{className:"p-4 space-y-3",children:[e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:"text-xs font-mono text-muted-foreground bg-muted/50 px-2 py-1 rounded",children:r.key}),e.jsx(N,{className:`${le(r.severity)} text-xs font-medium shrink-0`,children:r.severity})]})}),e.jsx("h4",{className:"font-medium text-sm leading-tight line-clamp-2 group-hover:text-primary transition-colors",children:r.title}),r.cveId&&e.jsx("p",{className:"text-xs text-muted-foreground",children:r.cveId}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["CVSS: ",r.cvssScore]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:r.asset})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[J(r.status),e.jsx("span",{className:"text-xs text-muted-foreground",children:r.status})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[new Date(r.dueDate)<new Date&&r.status!=="Fixed"&&e.jsx(N,{variant:"destructive",className:"text-xs",children:"Overdue"}),e.jsx(N,{variant:"outline",className:"text-xs bg-background/50",children:r.sourceLabel})]})]})]})},r.id)),m.filter(s.filter).length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center w-80 h-48 text-muted-foreground/50 border-2 border-dashed border-muted-foreground/20 rounded-xl",children:[e.jsx("div",{className:`w-8 h-8 rounded-full mb-2 ${s.severity==="Critical"?"bg-red-100":s.severity==="High"?"bg-orange-100":s.severity==="Medium"?"bg-yellow-100":"bg-green-100"}`}),e.jsxs("p",{className:"text-xs",children:["No ",s.severity.toLowerCase()," vulnerabilities"]})]})]}),e.jsx(x,{variant:"outline",size:"sm",className:"flex-shrink-0",onClick:()=>{const r=document.getElementById(`scroll-container-${s.severity}`);r&&r.scrollBy({left:300,behavior:"smooth"})},children:e.jsx(xe,{className:"h-4 w-4"})})]})})]},s.severity))}),k==="timeline"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-muted/30 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Vulnerability Discovery Timeline"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Last 30 days"})]}),e.jsx("div",{className:"space-y-4",children:c.sort((s,r)=>new Date(r.createdDate).getTime()-new Date(s.createdDate).getTime()).slice(0,10).map((s,r)=>{const D=new Date(s.createdDate),E=Date.now()-D.getTime()<10080*60*1e3;return e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${E?"bg-blue-600":"bg-gray-400"} border-2 border-white shadow-sm`}),r<9&&e.jsx("div",{className:"w-0.5 h-16 bg-gray-200"})]}),e.jsx("div",{className:"flex-1 pb-8",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(U,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-mono text-muted-foreground",children:s.key}),e.jsx(N,{className:le(s.severity),children:s.severity}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["CVSS: ",s.cvssScore]}),E&&e.jsx(N,{className:"bg-blue-100 text-blue-800 text-xs",children:"New"})]}),e.jsx("h4",{className:"text-sm font-medium mb-1",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:s.asset}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3"}),e.jsxs("span",{children:["Found: ",D.toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-3 w-3"}),e.jsxs("span",{children:["Source: ",s.sourceLabel]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[J(s.status),e.jsx("span",{children:s.status})]})]})]}),e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>I(s),className:"h-8 px-2",children:e.jsx(pe,{className:"h-4 w-4"})})]})})]},s.id)})}),e.jsx("div",{className:"mt-8 pt-6 border-t",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.filter(s=>(Date.now()-new Date(s.createdDate).getTime())/864e5<=7).length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Last 7 days"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:c.filter(s=>{const r=(Date.now()-new Date(s.createdDate).getTime())/864e5;return r>7&&r<=14}).length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"7-14 days ago"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:c.filter(s=>{const r=(Date.now()-new Date(s.createdDate).getTime())/864e5;return r>14&&r<=30}).length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"14-30 days ago"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:c.filter(s=>(Date.now()-new Date(s.createdDate).getTime())/864e5>30).length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"30+ days ago"})]})]})})]})})]})]}),e.jsx(Oe,{vulnerability:v,open:z,onOpenChange:w})]})}function ns({vulnerabilities:a}){const c=a.filter(t=>t.category==="offsec"),[v,V]=j.useState(null),[z,w]=j.useState(!1),[g,o]=j.useState([]),[d,i]=j.useState("severity"),[b,A]=j.useState("desc"),[S,$]=j.useState("all"),[y,W]=j.useState("all"),[n,F]=j.useState("list"),[k,M]=j.useState(1),C=10,P={total:c.length,critical:c.filter(t=>t.severity==="Critical").length,high:c.filter(t=>t.severity==="High").length,medium:c.filter(t=>t.severity==="Medium").length,low:c.filter(t=>t.severity==="Low").length,open:c.filter(t=>t.status==="Open").length,inProgress:c.filter(t=>t.status==="In Progress").length,fixed:c.filter(t=>t.status==="Fixed").length,overdue:c.filter(t=>t.status==="Fixed"||t.status==="Accepted"||t.status==="False Positive"?!1:new Date(t.dueDate)<new Date).length,avgCvss:c.reduce((t,l)=>t+l.cvssScore,0)/c.length||0},ie=t=>{switch(t){case"Critical":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"High":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200";case"Medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"Low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},_=t=>{switch(t){case"Fixed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"In Progress":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"Open":return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},ne=t=>{switch(t){case"Fixed":return e.jsx(R,{className:"h-4 w-4"});case"In Progress":return e.jsx(ae,{className:"h-4 w-4"});case"Open":return e.jsx(te,{className:"h-4 w-4"});case"Accepted":return e.jsx(q,{className:"h-4 w-4"});case"False Positive":return e.jsx(re,{className:"h-4 w-4"});default:return e.jsx(te,{className:"h-4 w-4"})}},he=t=>{switch(t){case"Critical":return 4;case"High":return 3;case"Medium":return 2;case"Low":return 1;default:return 0}},G=(t,l)=>{switch(t){case"severity":$(l);break;case"status":W(l);break}M(1)},T=t=>{V(t),w(!0)},le=(t,l)=>{o(l?m=>[...m,t]:m=>m.filter(L=>L!==t))},ue=t=>{o(t?X.map(l=>l.id):[])},J=t=>{console.log(`Bulk action: ${t} on vulnerabilities:`,g)},B=(t,l)=>{switch(console.log(`Action: ${t} on vulnerability:`,l.id),t){case"view":T(l);break;case"edit":console.log("Edit vulnerability:",l.id);break;case"assign":console.log("Assign vulnerability:",l.id);break;case"create-ticket":console.log("Create ticket for vulnerability:",l.id);break;case"export":console.log("Export vulnerability:",l.id);break;case"mark-fixed":console.log("Mark vulnerability as fixed:",l.id);break;case"delete":console.log("Delete vulnerability:",l.id);break;default:console.log("Unknown action:",t)}},O=c.filter(t=>S==="all"||t.severity===S).filter(t=>y==="all"||t.status===y).sort((t,l)=>{let m,L;switch(d){case"severity":m=he(t.severity),L=he(l.severity);break;case"cvssScore":m=t.cvssScore,L=l.cvssScore;break;case"status":m=t.status,L=l.status;break;case"createdDate":m=new Date(t.createdDate).getTime(),L=new Date(l.createdDate).getTime();break;case"dueDate":m=new Date(t.dueDate).getTime(),L=new Date(l.dueDate).getTime();break;default:m=t.severity,L=l.severity}return b==="asc"?m>L?1:-1:m<L?1:-1}),I=Math.ceil(O.length/C),Z=(k-1)*C,X=O.slice(Z,Z+C);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-blue-600"}),"Total Vulnerabilities"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold",children:P.total}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"OffSec vulnerabilities (open + fixed)"})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-red-600"}),"Critical"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:P.critical}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Requires immediate attention"})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-orange-600"}),"Overdue"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:P.overdue}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Past due date"})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-green-600"}),"Fixed"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:P.fixed}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Successfully remediated"})]})]}),e.jsxs(h,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(p,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-purple-600"}),"Avg CVSS Score"]})}),e.jsxs(u,{children:[e.jsx("div",{className:"text-3xl font-bold",children:P.avgCvss.toFixed(1)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Risk severity average"})]})]})]}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5"}),"OffSec Vulnerabilities",e.jsxs(N,{variant:"outline",children:[O.length," items"]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("select",{value:S,onChange:t=>G("severity",t.target.value),className:"px-3 py-1 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Severity"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),e.jsxs("select",{value:y,onChange:t=>G("status",t.target.value),className:"px-3 py-1 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"Open",children:"Open"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Fixed",children:"Fixed"})]}),e.jsxs("select",{value:`${d}-${b}`,onChange:t=>{const[l,m]=t.target.value.split("-");i(l),A(m)},className:"px-3 py-1 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"severity-desc",children:"Severity (High to Low)"}),e.jsx("option",{value:"severity-asc",children:"Severity (Low to High)"}),e.jsx("option",{value:"cvssScore-desc",children:"CVSS Score (High to Low)"}),e.jsx("option",{value:"cvssScore-asc",children:"CVSS Score (Low to High)"}),e.jsx("option",{value:"createdDate-desc",children:"Created Date (Newest)"}),e.jsx("option",{value:"createdDate-asc",children:"Created Date (Oldest)"}),e.jsx("option",{value:"dueDate-desc",children:"Due Date (Nearest)"}),e.jsx("option",{value:"dueDate-asc",children:"Due Date (Farthest)"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[e.jsx(x,{size:"sm",variant:n==="list"?"default":"outline",onClick:()=>F("list"),children:"List"}),e.jsx(x,{size:"sm",variant:n==="board"?"default":"outline",onClick:()=>F("board"),children:"Board"}),e.jsx(x,{size:"sm",variant:n==="timeline"?"default":"outline",onClick:()=>F("timeline"),children:"Timeline"})]})]})]}),e.jsxs(u,{children:[n==="list"&&e.jsxs("div",{className:"space-y-4",children:[g.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:[g.length," vulnerability",g.length>1?"s":""," selected"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{size:"sm",variant:"outline",onClick:()=>J("create-ticket"),children:"Create Ticket"}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>J("export"),children:"Export"}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>J("assign"),children:"Assign"}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>J("mark-fixed"),children:"Mark as Fixed"}),e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>o([]),children:"Clear Selection"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/30",children:[e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[5%]",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300",checked:g.length===X.length&&X.length>0,onChange:t=>ue(t.target.checked)})}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[15%]",children:"ID"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[28%]",children:"Title"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[10%]",children:"Severity"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[8%]",children:"CVSS"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[12%]",children:"Status"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[12%]",children:"Scan Type"}),e.jsx("th",{className:"text-left p-3 font-medium text-sm text-muted-foreground w-[10%]",children:"Date Found"}),e.jsx("th",{className:"text-center p-3 font-medium text-sm text-muted-foreground w-[10%]",children:"Actions"})]})}),e.jsx("tbody",{children:X.map(t=>e.jsxs("tr",{className:"border-b hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300",checked:g.includes(t.id),onChange:l=>le(t.id,l.target.checked)})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>T(t),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-muted-foreground font-mono",children:t.key})]})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>T(t),children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-medium text-sm hover:text-blue-600 transition-colors",children:t.title}),t.cveId&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t.cveId})]})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>T(t),children:e.jsx(N,{className:ie(t.severity),children:t.severity})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>T(t),children:e.jsx("span",{className:"text-sm font-medium",children:t.cvssScore})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>T(t),children:e.jsx(N,{className:_(t.status),children:t.status})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>T(t),children:e.jsx("div",{className:"text-sm",children:t.sourceLabel})}),e.jsx("td",{className:"p-3 cursor-pointer",onClick:()=>T(t),children:e.jsx("div",{className:"text-sm",children:new Date(t.createdDate).toLocaleDateString()})}),e.jsx("td",{className:"p-3 text-center",children:e.jsxs(Te,{children:[e.jsx(Ie,{asChild:!0,children:e.jsx(x,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsxs(Le,{align:"end",children:[e.jsxs(H,{onClick:()=>B("view",t),children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.jsxs(H,{onClick:()=>B("edit",t),children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(H,{onClick:()=>B("assign",t),children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Assign"]}),e.jsx(oe,{}),e.jsxs(H,{onClick:()=>B("create-ticket",t),children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Create Ticket"]}),e.jsxs(H,{onClick:()=>B("export",t),children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Export"]}),e.jsx(oe,{}),e.jsxs(H,{onClick:()=>B("mark-fixed",t),children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Mark as Fixed"]}),e.jsxs(H,{onClick:()=>B("delete",t),className:"text-red-600",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},t.id))})]})}),I>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",Z+1," to ",Math.min(Z+C,O.length)," of ",O.length," vulnerabilities"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>M(t=>Math.max(t-1,1)),disabled:k===1,children:[e.jsx(me,{className:"h-4 w-4"}),"Previous"]}),e.jsxs("span",{className:"text-sm",children:["Page ",k," of ",I]}),e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>M(t=>Math.min(t+1,I)),disabled:k===I,children:["Next",e.jsx(xe,{className:"h-4 w-4"})]})]})]}),X.length===0&&O.length>0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(K,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No vulnerabilities on this page"}),e.jsx("p",{className:"text-sm",children:"Try changing filters or going to a different page"})]}),O.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(K,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No OffSec vulnerabilities found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters"})]})]}),n==="board"&&e.jsx("div",{className:"space-y-6",children:[{severity:"Critical",color:"bg-red-500",filter:t=>t.severity==="Critical"},{severity:"High",color:"bg-orange-500",filter:t=>t.severity==="High"},{severity:"Medium",color:"bg-yellow-500",filter:t=>t.severity==="Medium"},{severity:"Low",color:"bg-green-500",filter:t=>t.severity==="Low"}].map(t=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-muted/50 to-muted/30 rounded-lg border border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.color}`}),e.jsx("h3",{className:"font-semibold text-sm",children:t.severity})]}),e.jsx(N,{variant:"secondary",className:"font-medium",children:O.filter(t.filter).length})]}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"outline",size:"sm",className:"flex-shrink-0",onClick:()=>{const l=document.getElementById(`scroll-container-offsec-${t.severity}`);l&&l.scrollBy({left:-300,behavior:"smooth"})},children:e.jsx(me,{className:"h-4 w-4"})}),e.jsxs("div",{id:`scroll-container-offsec-${t.severity}`,className:"flex gap-3 overflow-x-auto scrollbar-hide scroll-smooth p-1 bg-gradient-to-b from-background to-muted/20 rounded-xl border border-muted-foreground/20",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[O.filter(t.filter).map(l=>e.jsx(h,{className:"group cursor-pointer hover:shadow-lg hover:scale-[1.02] transition-all duration-200 border-border/50 bg-gradient-to-br from-card to-card/80 flex-shrink-0 w-80",onClick:()=>T(l),children:e.jsxs(u,{className:"p-4 space-y-3",children:[e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:"text-xs font-mono text-muted-foreground bg-muted/50 px-2 py-1 rounded",children:l.key}),e.jsx(N,{className:`${ie(l.severity)} text-xs font-medium shrink-0`,children:l.severity})]})}),e.jsx("h4",{className:"font-medium text-sm leading-tight line-clamp-2 group-hover:text-primary transition-colors",children:l.title}),l.cveId&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.cveId}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["CVSS: ",l.cvssScore]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:l.asset})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[ne(l.status),e.jsx("span",{className:"text-xs text-muted-foreground",children:l.status})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[new Date(l.dueDate)<new Date&&l.status!=="Fixed"&&e.jsx(N,{variant:"destructive",className:"text-xs",children:"Overdue"}),e.jsx(N,{variant:"outline",className:"text-xs bg-background/50",children:l.sourceLabel})]})]})]})},l.id)),O.filter(t.filter).length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center w-80 h-48 text-muted-foreground/50 border-2 border-dashed border-muted-foreground/20 rounded-xl",children:[e.jsx("div",{className:`w-8 h-8 rounded-full mb-2 ${t.severity==="Critical"?"bg-red-100":t.severity==="High"?"bg-orange-100":t.severity==="Medium"?"bg-yellow-100":"bg-green-100"}`}),e.jsxs("p",{className:"text-xs",children:["No ",t.severity.toLowerCase()," vulnerabilities"]})]})]}),e.jsx(x,{variant:"outline",size:"sm",className:"flex-shrink-0",onClick:()=>{const l=document.getElementById(`scroll-container-offsec-${t.severity}`);l&&l.scrollBy({left:300,behavior:"smooth"})},children:e.jsx(xe,{className:"h-4 w-4"})})]})})]},t.severity))}),n==="timeline"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Timeline View"}),e.jsx("p",{className:"text-muted-foreground",children:"Timeline view for OffSec vulnerabilities coming soon"})]})]})]}),e.jsx(Oe,{vulnerability:v,open:z,onOpenChange:w})]})}const ds=()=>{const a=[],c=["snyk_sca","snyk_sast","snyk_dast","manual_vapt"],v=["Critical","High","Medium","Low"],V=["Open","In Progress","Fixed"],z=["SQL Injection in Login Module","Cross-Site Scripting (XSS) in User Profile","Insecure Direct Object Reference","Broken Authentication in API","Sensitive Data Exposure","Security Misconfiguration","Insufficient Logging & Monitoring","Insecure Cryptographic Storage","Broken Access Control","Server-Side Request Forgery","XML External Entity Injection","Insecure Deserialization","Components with Known Vulnerabilities","Inadequate Security Controls","Cross-Site Request Forgery","Open Redirect Vulnerability","Path Traversal Attack","Command Injection","LDAP Injection","Buffer Overflow Vulnerability"],w=["Privilege Escalation in System","Remote Code Execution (RCE)","Denial of Service Vulnerability","Man-in-the-Middle Attack Vector","Weak SSL/TLS Configuration","Outdated System Components","Default Credentials Found","Unnecessary Services Running","Weak Encryption Algorithms","Information Disclosure","Network Service Misconfiguration","Weak Access Controls","Insufficient Input Validation","Session Hijacking Vulnerability","Race Condition Exploit","Memory Corruption Issue","Kernel Vulnerability","Web Application Firewall Bypass","Insufficient Rate Limiting","Weak Authentication Mechanisms"],g=["Axion API Gateway","User Authentication Service","Payment Processing Service","Customer Database Server","Web Application Frontend","Admin Dashboard","Mobile Application Backend","File Storage Service","Email Service Integration","Third-party API Integration"],o=new Date;for(let d=1;d<=150;d++){const i=d%2===0,b=i?c[Math.floor(Math.random()*3)]:"manual_vapt",A=i?z:w,S=A[Math.floor(Math.random()*A.length)],$=v[Math.floor(Math.random()*v.length)];let y;switch($){case"Critical":y=9+Math.random()*1;break;case"High":y=7+Math.random()*2;break;case"Medium":y=4+Math.random()*3;break;case"Low":y=.1+Math.random()*3.9;break;default:y=5}const W=Math.floor(Math.random()*90),n=new Date(o);n.setDate(n.getDate()-W);const F=7+Math.floor(Math.random()*23),k=new Date(n);k.setDate(k.getDate()+F);let M=V[Math.floor(Math.random()*V.length)],C=new Date(n);if(M==="Fixed"){const _=Math.floor(Math.random()*(F+10));C=new Date(n),C.setDate(C.getDate()+_)}else if(M==="In Progress"){const _=Math.floor(Math.random()*Math.min(W,30));C=new Date(o),C.setDate(C.getDate()-_)}let P;if(($==="Critical"||$==="High")&&Math.random()>.3){const _=n.getFullYear(),ne=Math.floor(Math.random()*99999);P=`CVE-${_}-${ne.toString().padStart(5,"0")}`}const ie={id:`VULN-${d.toString().padStart(4,"0")}`,key:`VULN-${d.toString().padStart(4,"0")}`,title:S,description:`Security vulnerability identified in ${S.toLowerCase()} requiring immediate attention and remediation.`,category:i?"appsec":"offsec",severity:$,status:M,cvssScore:Math.round(y*10)/10,source:b,sourceLabel:i?b.replace("_"," ").toUpperCase():"Manual VAPT",asset:g[Math.floor(Math.random()*g.length)],assetType:i?"Application":"Infrastructure",project:"Axion Security Platform",assignee:M==="Open"||M==="In Progress"?["alice.johnson@company.com","bob.smith@company.com","carol.davis@company.com"][Math.floor(Math.random()*3)]:void 0,createdDate:n.toISOString(),updatedDate:C.toISOString(),dueDate:k.toISOString(),cveId:P,riskScore:Math.round(y*10),affectedComponent:i?"Web Application":"System Service",remediation:`Apply security patches and implement proper security controls to mitigate the ${S.toLowerCase()} vulnerability.`,references:P?[`https://cve.mitre.org/cgi-bin/cvename.cgi?name=${P}`]:[],tags:[$,i?"AppSec":"OffSec",b]};a.push(ie)}return a.sort((d,i)=>{const b={Critical:0,High:1,Medium:2,Low:3},A=b[d.severity],S=b[i.severity];return A!==S?A-S:new Date(i.createdDate).getTime()-new Date(d.createdDate).getTime()})},fe=ds(),os=a=>{const c=a.length,v=a.filter(n=>n.category==="appsec").length,V=a.filter(n=>n.category==="offsec").length,z=a.filter(n=>n.severity==="Critical").length,w=a.filter(n=>n.severity==="High").length,g=a.filter(n=>n.severity==="Medium").length,o=a.filter(n=>n.severity==="Low").length,d=a.filter(n=>n.status==="Open").length,i=a.filter(n=>n.status==="In Progress").length,b=a.filter(n=>n.status==="Fixed").length,A=new Date,S=a.filter(n=>n.status==="Fixed"?!1:new Date(n.dueDate)<A).length,$=a.reduce((n,F)=>n+F.cvssScore,0)/c,y=a.filter(n=>n.status==="Fixed"),W=y.length>0?y.reduce((n,F)=>{const k=new Date(F.createdDate),M=new Date(F.updatedDate);return n+(M.getTime()-k.getTime())/(1e3*60*60*24)},0)/y.length:0;return{total:c,appsec:v,offsec:V,critical:z,high:w,medium:g,low:o,open:d,inProgress:i,fixed:b,overdue:S,avgCvss:Math.round($*10)/10,mttr:Math.round(W*10)/10}},Ae=[{id:"tenant-1",name:"Production Tenant",type:"tenant"},{id:"tenant-2",name:"Staging Tenant",type:"tenant"},{id:"tenant-3",name:"Development Tenant",type:"tenant"}],xs=[{id:"axion-platform",name:"Axion Security Platform",type:"project",tenantId:"tenant-1"}],Me=()=>{const a=[];return Ae.forEach(c=>{a.push({id:c.id,name:c.name,type:"tenant",level:0})}),xs.forEach(c=>{const v=Ae.find(V=>V.id===c.tenantId);a.push({id:c.id,name:c.name,type:"project",tenantId:c.tenantId,tenantName:v?.name,level:1})}),a};function ms(){const[a,c]=j.useState("overview"),[v,V]=j.useState("axion-platform"),w=(!v||!Me().find(i=>i.id===v),fe),g=os(w);return e.jsxs("div",{className:"flex flex-1 flex-col gap-4",children:[e.jsx(ze,{children:e.jsxs("div",{className:"ml-auto flex items-center space-x-2",children:[e.jsx($e,{}),e.jsx(Ue,{}),e.jsx(Re,{})]})}),e.jsxs(Be,{className:"flex flex-1 flex-col gap-4 sm:gap-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Vulnerability Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Track and manage security vulnerabilities across AppSec and OffSec domains"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(Ke,{value:v,onValueChange:V,children:[e.jsx(qe,{className:"w-64",children:e.jsx(Ge,{placeholder:"Select asset"})}),e.jsx(Je,{children:Me().map(o=>e.jsx(Xe,{value:o.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[o.type==="project"&&e.jsx(ts,{className:"h-4 w-4"}),e.jsx("span",{children:o.name})]})},o.id))})]})]})]}),e.jsxs(We,{value:a,onValueChange:c,className:"w-full",children:[e.jsxs(_e,{className:"grid w-full grid-cols-3",children:[e.jsxs(ge,{value:"overview",className:"flex items-center gap-2",children:[e.jsx(is,{className:"h-4 w-4"}),"Overview"]}),e.jsxs(ge,{value:"appsec",className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"AppSec"]}),e.jsxs(ge,{value:"offsec",className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"OffSec"]})]}),e.jsx(je,{value:"overview",children:e.jsx(ls,{stats:g})}),e.jsx(je,{value:"appsec",children:e.jsx(cs,{vulnerabilities:w.filter(o=>o.category==="appsec")})}),e.jsx(je,{value:"offsec",children:e.jsx(ns,{vulnerabilities:w.filter(o=>o.category==="offsec")})})]})]}),e.jsx(Ee,{})]})}const at=ms;export{at as component};
