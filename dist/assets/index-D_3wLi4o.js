import{c as Z,r,j as e,B as U,S as W,U as le}from"./index-oxLYDS5M.js";import{I as de}from"./input-C5yHoIy3.js";import{B as O}from"./badge-D9o7aS9a.js";import{a as me,b as pe,S as ue,X as xe,T as A}from"./scroll-area-BimYXtn5.js";import{A as X}from"./activity-TpUOlpS8.js";import{B as Q}from"./building-2-C5GqdzMi.js";import{C as se}from"./calendar-syglnTsf.js";import{C as H}from"./clock-DdRsUkfZ.js";import{E as he}from"./eye-B1F4H6XP.js";import{R as ge}from"./rotate-ccw-BB5IJiA8.js";import{Z as fe}from"./zap-CW9dCse3.js";import{C as ve}from"./circle-x-CuqOFExx.js";import{T as te}from"./triangle-alert-Ds-6GkSI.js";import{C as ye}from"./circle-check-DunOFx40.js";import"./index-BPnUvQlg.js";import"./index-Cm2yHs3V.js";import"./index-BX0_rYSh.js";import"./index-D3MmCfGe.js";import"./index-Bs3SSA5T.js";const je=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],ke=Z("maximize-2",je);const Ne=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],be=Z("zoom-in",Ne);const we=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],$e=Z("zoom-out",we);function Se({flowBoxes:l,isLoading:k,selectedFlow:Y,setSelectedFlow:F,selectedTenant:G,setSelectedTenant:J,focusedTenant:g,setFocusedTenant:N,searchQuery:f,setSearchQuery:E,zoom:p,setZoom:u,canvasOffset:d,setCanvasOffset:R,isDragging:v,setIsDragging:b,dragStart:w,setDragStart:z,draggedBox:m,setDraggedBox:$,boxDragStart:S,setBoxDragStart:B,setFlowBoxes:q,mockTenants:T}){const C=r.useRef(null),D=r.useRef(null),M=s=>{switch(s){case"completed":return"bg-green-500";case"in-progress":return"bg-blue-500";case"pending-review":return"bg-yellow-500";case"remediation-required":return"bg-orange-500";case"sla-at-risk":return"bg-red-400";case"sla-missed":return"bg-red-600";case"risk-accepted":return"bg-purple-500";case"scheduled":return"bg-gray-500";default:return"bg-gray-400"}},t=s=>{switch(s){case"completed":return e.jsx(ye,{className:"h-4 w-4"});case"in-progress":return e.jsx(X,{className:"h-4 w-4"});case"pending-review":return e.jsx(H,{className:"h-4 w-4"});case"remediation-required":return e.jsx(te,{className:"h-4 w-4"});case"sla-at-risk":return e.jsx(te,{className:"h-4 w-4"});case"sla-missed":return e.jsx(ve,{className:"h-4 w-4"});case"risk-accepted":return e.jsx(W,{className:"h-4 w-4"});case"scheduled":return e.jsx(se,{className:"h-4 w-4"});default:return e.jsx(H,{className:"h-4 w-4"})}},y=s=>{switch(s){case"approval":return e.jsx(W,{className:"h-5 w-5"});case"appsec-scan":return e.jsx(fe,{className:"h-5 w-5"});case"appsec-results":return e.jsx(A,{className:"h-5 w-5"});case"ticket-creation":return e.jsx(le,{className:"h-5 w-5"});case"remediation":return e.jsx(ge,{className:"h-5 w-5"});case"verification":return e.jsx(he,{className:"h-5 w-5"});case"risk-acceptance":return e.jsx(W,{className:"h-5 w-5"});case"offsec-vapt":return e.jsx(A,{className:"h-5 w-5"});case"offsec-report":return e.jsx(A,{className:"h-5 w-5"});case"sla-tracking":return e.jsx(H,{className:"h-5 w-5"});case"quarterly-schedule":return e.jsx(se,{className:"h-5 w-5"});default:return e.jsx(X,{className:"h-5 w-5"})}},V=s=>{s.preventDefault();const a=s.target,i=a.closest(".flow-box"),c=!i&&(a===D.current||a.classList.contains("canvas-container")||a.classList.contains("canvas-dots-light")||a.classList.contains("canvas-dots-dark")||a.classList.contains("transition-transform"));console.log("Canvas click check:",{target:a.tagName,targetClass:a.className,isCanvasClick:c,isFlowBox:i,containerRef:D.current?.tagName}),c&&(b(!0),z({x:s.clientX-d.x,y:s.clientY-d.y}),s.preventDefault())},ae=s=>{if(console.log("Mouse move:",{isDragging:v,draggedBox:m,canvasOffset:d}),v&&!m){const a=s.clientX-w.x,i=s.clientY-w.y;console.log("Canvas panning to:",{newX:a,newY:i}),R({x:a,y:i})}if(m){const a=s.clientX-S.x,i=s.clientY-S.y;q(c=>c.map(n=>n.id===m?{...n,position:{x:a,y:i}}:n))}},ie=()=>{b(!1),$(null)},re=(s,a)=>{s.preventDefault(),s.stopPropagation();const i=l.find(c=>c.id===a);i&&($(a),B({x:s.clientX-i.position.x,y:s.clientY-i.position.y}))},ne=s=>{s.preventDefault();const a=s.deltaY>0?.9:1.1;u(i=>Math.min(Math.max(i*a,.3),3))},ce=(s=>s.map(a=>({id:a.id,name:a.name,type:"tenant",children:a.environments.map(i=>({id:i.id,name:i.name,type:"environment",parent:a.id}))})))(T);return k?e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(X,{className:"mx-auto h-12 w-12 animate-spin text-blue-600"}),e.jsx("p",{className:"mt-4 text-lg font-medium",children:"Loading OmniFlow..."})]})}):e.jsxs(me,{children:[e.jsx("style",{children:`
        .canvas-dots-light {
          background-image: radial-gradient(circle, #d1d5db 1px, transparent 1px);
          background-size: 20px 20px;
        }
        .canvas-dots-dark {
          background-image: radial-gradient(circle, #374151 1px, transparent 1px);
          background-size: 20px 20px;
        }
      `}),e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-background",children:[e.jsxs("div",{className:"w-80 bg-white dark:bg-card border-r border-gray-200 dark:border-border",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-foreground",children:"OmniFlow"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-muted-foreground mt-1",children:"Security Workflow Visualization"})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx(de,{placeholder:"Search tenants...",value:f,onChange:s=>E(s.target.value),className:"pl-10"})]})}),e.jsx(ue,{className:"flex-1 h-[calc(100vh-200px)]",children:e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-2",children:ce.map(s=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg cursor-pointer transition-colors ${g===s.id?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-foreground"}`,onClick:()=>N(s.id),children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:s.name}),e.jsx(O,{variant:"outline",className:"ml-auto",children:s.children?.length||0})]}),s.children?.map(a=>e.jsxs("div",{className:"ml-4 flex items-center gap-2 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer transition-colors text-gray-600 dark:text-muted-foreground",children:[e.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:a.name})]},a.id))]},s.id))})})}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-border",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(U,{variant:"outline",size:"sm",onClick:()=>u(1),className:"flex items-center gap-1",children:[e.jsx(ke,{className:"h-4 w-4"}),"Reset"]}),e.jsx(U,{variant:"outline",size:"sm",onClick:()=>u(p*1.2),className:"flex items-center gap-1",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx(U,{variant:"outline",size:"sm",onClick:()=>u(p*.8),className:"flex items-center gap-1",children:e.jsx($e,{className:"h-4 w-4"})})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"bg-white dark:bg-card border-b border-gray-200 dark:border-border p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-foreground",children:"Security Workflow Visualization"}),g&&e.jsxs("div",{className:"ml-4 flex items-center gap-2 px-3 py-1 bg-blue-100 dark:bg-blue-900/30 rounded-full",children:[e.jsx(Q,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:T.find(s=>s.id===g)?.name}),e.jsx("button",{onClick:()=>N(""),className:"ml-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200",children:e.jsx(xe,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(O,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3"}),l.length," Flows"]}),e.jsxs(O,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(A,{className:"h-3 w-3"}),Math.round(p*100),"%"]})]})]})}),e.jsx("div",{ref:D,className:"flex-1 relative overflow-hidden bg-gray-50 dark:bg-background canvas-container canvas-dots-light dark:canvas-dots-dark select-none",onMouseDown:V,onMouseMove:ae,onMouseUp:ie,onWheel:ne,style:{cursor:v?"grabbing":"grab"},children:e.jsxs("div",{ref:C,className:"relative transition-transform duration-100 select-none",style:{transform:`scale(${p}) translate(${d.x}px, ${d.y}px)`,transformOrigin:"0 0",width:"10000px",height:"1400px"},children:[e.jsxs("svg",{className:"absolute top-0 left-0 pointer-events-none",style:{width:"10000px",height:"1400px"},children:[e.jsx("defs",{children:e.jsx("marker",{id:"arrowhead",markerWidth:"12",markerHeight:"8",refX:"11",refY:"4",orient:"auto",children:e.jsx("polygon",{points:"0 0, 12 4, 0 8",fill:"#6B7280"})})}),l.map(s=>s.connections.map(a=>{const i=l.find(o=>o.id===a);if(!i)return null;const c=s.position.x+90,n=s.position.y+40,K=i.position.x,L=i.position.y+40,j=s.id.includes("revalidation-fixed")&&a.includes("revalidation");let P;if(j){const o=s.position.x+180,_=s.position.y+40,x=i.position.x,h=i.position.y+40,oe=Math.min(o+150,9500),I=Math.min(_+150,1250),ee=Math.max(x-150,500);P=`M ${o} ${_} 
                                  L ${oe} ${I} 
                                  L ${ee} ${I} 
                                  L ${ee} ${h}`}else{const o=(c+K)/2,_=(n+L)/2;let x,h;L<n?(x=o,h=n-80):L>n?(x=o,h=n+80):(x=o+50,h=_),P=`M ${c} ${n} Q ${x} ${h} ${K} ${L}`}return e.jsx("g",{children:e.jsx("path",{d:P,stroke:j?"#DC2626":"#6B7280",strokeWidth:j?"3":"2",fill:"none",markerEnd:"url(#arrowhead)",className:`transition-all duration-300 ${j?"animate-pulse":""}`,strokeDasharray:j?"5,5":"none"})},`${s.id}-${a}`)}))]}),l.map(s=>e.jsx("div",{className:`flow-box absolute bg-white dark:bg-card rounded-lg shadow-lg border-2 transition-all duration-300 select-none ${Y===s.id?"border-blue-500 shadow-xl":"border-gray-200 dark:border-border hover:border-gray-300 dark:hover:border-gray-600"} ${m===s.id?"cursor-grabbing z-50":"cursor-grab"}`,style:{left:`${s.position.x}px`,top:`${s.position.y}px`,width:"180px",minHeight:"80px"},onClick:()=>F(s.id),onMouseDown:a=>re(a,s.id),children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`p-1 rounded ${M(s.status)} bg-opacity-20 text-white`,children:y(s.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-foreground truncate",children:s.title})})]}),e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${M(s.status)} bg-opacity-20 text-white`,children:[t(s.status),e.jsx("span",{className:"capitalize",children:s.status.replace("-"," ")})]})}),s.data.vulnerabilities&&e.jsx("div",{className:"text-xs text-gray-600 dark:text-muted-foreground",children:e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsxs("span",{children:["C: ",s.data.vulnerabilities.critical]}),e.jsxs("span",{children:["H: ",s.data.vulnerabilities.high]}),e.jsxs("span",{children:["M: ",s.data.vulnerabilities.medium]}),e.jsxs("span",{children:["L: ",s.data.vulnerabilities.low]})]})}),s.data.tickets&&e.jsxs("div",{className:"text-xs text-gray-600 dark:text-muted-foreground mt-1",children:["Tickets: ",s.data.tickets]}),s.data.sla&&e.jsxs("div",{className:"text-xs text-gray-600 dark:text-muted-foreground mt-1",children:["SLA: ",s.data.sla.remainingDays," days"]}),s.data.completedDate&&e.jsxs("div",{className:"text-xs text-gray-600 dark:text-muted-foreground mt-1",children:["Completed: ",s.data.completedDate]})]})},s.id))]})})]})]})]})}function Te(){const[l,k]=r.useState([]),[Y,F]=r.useState(!0),[G,J]=r.useState(null),[g,N]=r.useState(""),[f,E]=r.useState(""),[p,u]=r.useState(""),[d,R]=r.useState(1),[v,b]=r.useState({x:0,y:0}),[w,z]=r.useState(!1),[m,$]=r.useState({x:0,y:0}),[S,B]=r.useState(null),[q,T]=r.useState({x:0,y:0}),C=[{id:"TENANT-001",name:"Acme Corporation",type:"enterprise",status:"active",assets_count:156,vulnerabilities_count:23,risk_score:7.2,last_scan:"2024-06-15",environments:[{id:"ENV-001",name:"Production",type:"production",description:"Main production environment",url:"https://app.acme.com",status:"active",vulnerabilities_count:15,risk_score:8.1},{id:"ENV-002",name:"Staging",type:"staging",description:"Staging environment for testing",url:"https://staging.acme.com",status:"active",vulnerabilities_count:8,risk_score:5.3}]},{id:"TENANT-002",name:"Tech Startup Inc",type:"startup",status:"active",assets_count:45,vulnerabilities_count:12,risk_score:4.8,last_scan:"2024-06-14",environments:[{id:"ENV-003",name:"Production",type:"production",description:"Production environment",url:"https://app.techstartup.com",status:"active",vulnerabilities_count:12,risk_score:4.8}]}];return r.useEffect(()=>{const M=(t=>{if(t){const y=C.find(V=>V.id===t);return y?t==="TENANT-001"?[{id:`${t}-main`,title:`${y.name} - Security Activities`,type:"approval",status:"in-progress",position:{x:600,y:400},connections:[`${t}-appsec`,`${t}-offsec`],data:{team:"appsec"}},{id:`${t}-appsec`,title:"AppSec Pipeline",type:"appsec-scan",status:"in-progress",position:{x:900,y:250},connections:[`${t}-sca`,`${t}-sast`,`${t}-dast`],data:{team:"appsec",scanType:"sca"}},{id:`${t}-sca`,title:"SCA - Dependencies Scan",type:"appsec-scan",status:"completed",position:{x:1200,y:200},connections:[`${t}-vulnerabilities`],data:{team:"appsec",scanType:"sca",vulnerabilities:{critical:3,high:7,medium:12,low:18},completedDate:"2024-06-10"}},{id:`${t}-sast`,title:"SAST - Code Analysis",type:"appsec-scan",status:"in-progress",position:{x:1200,y:400},connections:[`${t}-vulnerabilities`],data:{team:"appsec",scanType:"sast",vulnerabilities:{critical:1,high:4,medium:8,low:11}}},{id:`${t}-dast`,title:"DAST - Dynamic Testing",type:"appsec-scan",status:"pending-review",position:{x:1200,y:600},connections:[`${t}-vulnerabilities`],data:{team:"appsec",scanType:"dast",vulnerabilities:{critical:0,high:2,medium:5,low:7}}},{id:`${t}-vulnerabilities`,title:"Vulnerability Findings",type:"appsec-results",status:"remediation-required",position:{x:1600,y:400},connections:[`${t}-remediation-queue`],data:{team:"appsec",vulnerabilities:{critical:4,high:13,medium:25,low:36}}},{id:`${t}-remediation-queue`,title:"Remediation Queue",type:"ticket-creation",status:"remediation-required",position:{x:2e3,y:400},connections:[`${t}-accepted-risk`,`${t}-fixed`],data:{team:"development",tickets:15,riskLevel:"high"}},{id:`${t}-accepted-risk`,title:"Accepted Risk",type:"risk-acceptance",status:"risk-accepted",position:{x:2400,y:250},connections:[],data:{team:"appsec",riskLevel:"medium",vulnerabilities:{critical:0,high:3,medium:5,low:8}}},{id:`${t}-fixed`,title:"Fixed Vulnerabilities",type:"remediation",status:"completed",position:{x:2400,y:550},connections:[],data:{team:"development",tickets:12,completedDate:"2024-06-15"}},{id:`${t}-offsec`,title:"OffSec Pipeline",type:"offsec-vapt",status:"in-progress",position:{x:900,y:650},connections:[`${t}-manual-vapt`],data:{team:"offsec",scanType:"manual-vapt"}},{id:`${t}-manual-vapt`,title:"Manual VAPT Testing",type:"offsec-vapt",status:"completed",position:{x:1200,y:650},connections:[`${t}-offsec-vulnerabilities`],data:{team:"offsec",scanType:"manual-vapt",vulnerabilities:{critical:2,high:5,medium:8,low:12},completedDate:"2024-06-12"}},{id:`${t}-offsec-vulnerabilities`,title:"Vulnerability Findings",type:"offsec-report",status:"remediation-required",position:{x:1600,y:650},connections:[`${t}-offsec-remediation`],data:{team:"offsec",vulnerabilities:{critical:2,high:5,medium:8,low:12}}},{id:`${t}-offsec-remediation`,title:"Remediation Queue",type:"ticket-creation",status:"remediation-required",position:{x:2e3,y:650},connections:[`${t}-offsec-accepted`,`${t}-offsec-fixed`],data:{team:"development",tickets:8,riskLevel:"high"}},{id:`${t}-offsec-accepted`,title:"Accepted Risk",type:"risk-acceptance",status:"risk-accepted",position:{x:2400,y:600},connections:[],data:{team:"offsec",riskLevel:"medium",vulnerabilities:{critical:0,high:1,medium:2,low:3}}},{id:`${t}-offsec-fixed`,title:"Fixed Vulnerabilities",type:"remediation",status:"completed",position:{x:2400,y:700},connections:[],data:{team:"development",tickets:7,completedDate:"2024-06-16"}}]:t==="TENANT-002"?[{id:`${t}-inactive`,title:`${y.name} - Inactive`,type:"approval",status:"scheduled",position:{x:1800,y:400},connections:[],data:{team:"appsec",scheduledDate:"2024-07-01"}}]:[]:[]}else return[{id:"no-tenant-selected",title:"Select a tenant to view security activities",type:"approval",status:"scheduled",position:{x:1800,y:400},connections:[],data:{team:"appsec"}}]})(f||void 0);setTimeout(()=>{k(M),F(!1)},1e3)},[f]),e.jsx(Se,{flowBoxes:l,isLoading:Y,selectedFlow:G,setSelectedFlow:J,selectedTenant:g,setSelectedTenant:N,focusedTenant:f,setFocusedTenant:E,searchQuery:p,setSearchQuery:u,zoom:d,setZoom:R,canvasOffset:v,setCanvasOffset:b,isDragging:w,setIsDragging:z,dragStart:m,setDragStart:$,draggedBox:S,setDraggedBox:B,boxDragStart:q,setBoxDragStart:T,setFlowBoxes:k,mockTenants:C})}const Je=Te;export{Je as component};
