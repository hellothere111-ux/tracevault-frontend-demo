import{c as O,r as g,j as e,m as ee,n as qe,d as We,B as C,S as ne,C as he}from"./index-CyLddbD6.js";import{C as v,d as D,a as z,b as U,c as Xe}from"./card-BTqXV1RT.js";import{C as Ye}from"./config-drawer-D0Lvmk0a.js";import{H as Ge,S as Je}from"./search-CdXJDppT.js";import{M as Qe}from"./main-CnnvO0gv.js";import{T as es}from"./top-nav-sc-uNMfO.js";import{P as ss}from"./profile-dropdown-BfnLNWIf.js";import{T as as}from"./theme-switch-BR8ZSlRP.js";import{I as ts}from"./input-CXl4TFaQ.js";import{B as R}from"./badge-DHUMdwZJ.js";import{C as M,a as E,b as I}from"./collapsible-4yL-RlLe.js";import{C as Z}from"./checkbox-D8QSamv4.js";import{c as Ae}from"./index-XYn7pLoo.js";import{u as ns,c as rs,a as Q,P as ie,b as is}from"./index-De73T7We.js";import{u as cs}from"./index-DhnNAsvm.js";import{c as ls}from"./index-C626fjWP.js";import{C as L,S as os,a as ds,b as ms,c as us,d as ps}from"./select-TQwDUQ4A.js";import{X as ge,B as xs,E as Se,D as hs,f as gs,g as fs,j as Y,F as vs,G as js,H as ys,I as bs,J as _s}from"./confirm-dialog-pAXck9NV.js";import{T as re,a as Ns,b as Ss,c as we,d as K,e as ws,f as q}from"./table-DP-dC8Hx.js";import{E as fe}from"./eye-BIYauoJj.js";import{C as ve}from"./clock-CXMngBxy.js";import{T as ue}from"./target-Df4kaJb8.js";import{T as ks,U as Cs}from"./user-B8uGKb8w.js";import{D as de}from"./download-DdW9dr7O.js";import{R as Ts}from"./refresh-cw-CQ3Mz52n.js";import{E as As}from"./external-link-DtUrVlIs.js";import{T as Pe,a as De,b as W,c as pe}from"./tabs-Na2_x9CK.js";import"./index-BbeBjg-j.js";import"./index-BkYwP1Fm.js";import"./index-iG58nOgD.js";import"./index-CPEMSmfu.js";import"./sign-out-dialog-I2FQ1cpp.js";import"./separator-CrVCV9Cl.js";import"./check-BxIkDk5N.js";import"./index-d5d2tWRm.js";const Ps=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],ke=O("building",Ps);const Ds=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Rs=O("calendar-days",Ds);const Vs=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Ce=O("code",Vs);const Ms=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],xe=O("database",Ms);const Es=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Is=O("ellipsis",Es);const Ls=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],zs=O("funnel",Ls);const Us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],oe=O("globe",Us);const Os=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Fs=O("hash",Os);const Zs=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Hs=O("layers",Zs);const Bs=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],$s=O("message-square",Bs);const Ks=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],F=O("server",Ks);const qs=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Te=O("shield-alert",qs);var Re=["PageUp","PageDown"],Ve=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Me={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},se="Slider",[je,Ws,Xs]=ls(se),[Ee]=rs(se,[Xs]),[Ys,me]=Ee(se),Ie=g.forwardRef((s,l)=>{const{name:r,min:a=0,max:d=100,step:o=1,orientation:p="horizontal",disabled:m=!1,minStepsBetweenThumbs:j=0,defaultValue:S=[a],value:u,onValueChange:x=()=>{},onValueCommit:h=()=>{},inverted:f=!1,form:N,...w}=s,n=g.useRef(new Set),b=g.useRef(0),A=p==="horizontal"?Gs:Js,[y=[],$]=ns({prop:u,defaultProp:S,onChange:k=>{[...n.current][b.current]?.focus(),x(k)}}),X=g.useRef(y);function G(k){const i=ta(y,k);_(k,i)}function t(k){_(k,b.current)}function T(){const k=X.current[b.current];y[b.current]!==k&&h(y)}function _(k,i,{commit:V}={commit:!1}){const B=ca(o),ae=la(Math.round((k-a)/o)*o+a,B),J=Ae(ae,[a,d]);$((c=[])=>{const P=sa(c,J,i);if(ia(P,j*o)){b.current=P.indexOf(J);const ce=String(P)!==String(c);return ce&&V&&h(P),ce?P:c}else return c})}return e.jsx(Ys,{scope:s.__scopeSlider,name:r,disabled:m,min:a,max:d,valueIndexToChangeRef:b,thumbs:n.current,values:y,orientation:p,form:N,children:e.jsx(je.Provider,{scope:s.__scopeSlider,children:e.jsx(je.Slot,{scope:s.__scopeSlider,children:e.jsx(A,{"aria-disabled":m,"data-disabled":m?"":void 0,...w,ref:l,onPointerDown:Q(w.onPointerDown,()=>{m||(X.current=y)}),min:a,max:d,inverted:f,onSlideStart:m?void 0:G,onSlideMove:m?void 0:t,onSlideEnd:m?void 0:T,onHomeKeyDown:()=>!m&&_(a,0,{commit:!0}),onEndKeyDown:()=>!m&&_(d,y.length-1,{commit:!0}),onStepKeyDown:({event:k,direction:i})=>{if(!m){const ae=Re.includes(k.key)||k.shiftKey&&Ve.includes(k.key)?10:1,J=b.current,c=y[J],P=o*ae*i;_(c+P,J,{commit:!0})}}})})})})});Ie.displayName=se;var[Le,ze]=Ee(se,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Gs=g.forwardRef((s,l)=>{const{min:r,max:a,dir:d,inverted:o,onSlideStart:p,onSlideMove:m,onSlideEnd:j,onStepKeyDown:S,...u}=s,[x,h]=g.useState(null),f=ee(l,A=>h(A)),N=g.useRef(void 0),w=qe(d),n=w==="ltr",b=n&&!o||!n&&o;function H(A){const y=N.current||x.getBoundingClientRect(),$=[0,y.width],G=Ne($,b?[r,a]:[a,r]);return N.current=y,G(A-y.left)}return e.jsx(Le,{scope:s.__scopeSlider,startEdge:b?"left":"right",endEdge:b?"right":"left",direction:b?1:-1,size:"width",children:e.jsx(Ue,{dir:w,"data-orientation":"horizontal",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:A=>{const y=H(A.clientX);p?.(y)},onSlideMove:A=>{const y=H(A.clientX);m?.(y)},onSlideEnd:()=>{N.current=void 0,j?.()},onStepKeyDown:A=>{const $=Me[b?"from-left":"from-right"].includes(A.key);S?.({event:A,direction:$?-1:1})}})})}),Js=g.forwardRef((s,l)=>{const{min:r,max:a,inverted:d,onSlideStart:o,onSlideMove:p,onSlideEnd:m,onStepKeyDown:j,...S}=s,u=g.useRef(null),x=ee(l,u),h=g.useRef(void 0),f=!d;function N(w){const n=h.current||u.current.getBoundingClientRect(),b=[0,n.height],A=Ne(b,f?[a,r]:[r,a]);return h.current=n,A(w-n.top)}return e.jsx(Le,{scope:s.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:e.jsx(Ue,{"data-orientation":"vertical",...S,ref:x,style:{...S.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:w=>{const n=N(w.clientY);o?.(n)},onSlideMove:w=>{const n=N(w.clientY);p?.(n)},onSlideEnd:()=>{h.current=void 0,m?.()},onStepKeyDown:w=>{const b=Me[f?"from-bottom":"from-top"].includes(w.key);j?.({event:w,direction:b?-1:1})}})})}),Ue=g.forwardRef((s,l)=>{const{__scopeSlider:r,onSlideStart:a,onSlideMove:d,onSlideEnd:o,onHomeKeyDown:p,onEndKeyDown:m,onStepKeyDown:j,...S}=s,u=me(se,r);return e.jsx(ie.span,{...S,ref:l,onKeyDown:Q(s.onKeyDown,x=>{x.key==="Home"?(p(x),x.preventDefault()):x.key==="End"?(m(x),x.preventDefault()):Re.concat(Ve).includes(x.key)&&(j(x),x.preventDefault())}),onPointerDown:Q(s.onPointerDown,x=>{const h=x.target;h.setPointerCapture(x.pointerId),x.preventDefault(),u.thumbs.has(h)?h.focus():a(x)}),onPointerMove:Q(s.onPointerMove,x=>{x.target.hasPointerCapture(x.pointerId)&&d(x)}),onPointerUp:Q(s.onPointerUp,x=>{const h=x.target;h.hasPointerCapture(x.pointerId)&&(h.releasePointerCapture(x.pointerId),o(x))})})}),Oe="SliderTrack",Fe=g.forwardRef((s,l)=>{const{__scopeSlider:r,...a}=s,d=me(Oe,r);return e.jsx(ie.span,{"data-disabled":d.disabled?"":void 0,"data-orientation":d.orientation,...a,ref:l})});Fe.displayName=Oe;var ye="SliderRange",Ze=g.forwardRef((s,l)=>{const{__scopeSlider:r,...a}=s,d=me(ye,r),o=ze(ye,r),p=g.useRef(null),m=ee(l,p),j=d.values.length,S=d.values.map(h=>$e(h,d.min,d.max)),u=j>1?Math.min(...S):0,x=100-Math.max(...S);return e.jsx(ie.span,{"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,...a,ref:m,style:{...s.style,[o.startEdge]:u+"%",[o.endEdge]:x+"%"}})});Ze.displayName=ye;var be="SliderThumb",He=g.forwardRef((s,l)=>{const r=Ws(s.__scopeSlider),[a,d]=g.useState(null),o=ee(l,m=>d(m)),p=g.useMemo(()=>a?r().findIndex(m=>m.ref.current===a):-1,[r,a]);return e.jsx(Qs,{...s,ref:o,index:p})}),Qs=g.forwardRef((s,l)=>{const{__scopeSlider:r,index:a,name:d,...o}=s,p=me(be,r),m=ze(be,r),[j,S]=g.useState(null),u=ee(l,H=>S(H)),x=j?p.form||!!j.closest("form"):!0,h=is(j),f=p.values[a],N=f===void 0?0:$e(f,p.min,p.max),w=aa(a,p.values.length),n=h?.[m.size],b=n?na(n,N,m.direction):0;return g.useEffect(()=>{if(j)return p.thumbs.add(j),()=>{p.thumbs.delete(j)}},[j,p.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[m.startEdge]:`calc(${N}% + ${b}px)`},children:[e.jsx(je.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(ie.span,{role:"slider","aria-label":s["aria-label"]||w,"aria-valuemin":p.min,"aria-valuenow":f,"aria-valuemax":p.max,"aria-orientation":p.orientation,"data-orientation":p.orientation,"data-disabled":p.disabled?"":void 0,tabIndex:p.disabled?void 0:0,...o,ref:u,style:f===void 0?{display:"none"}:s.style,onFocus:Q(s.onFocus,()=>{p.valueIndexToChangeRef.current=a})})}),x&&e.jsx(Be,{name:d??(p.name?p.name+(p.values.length>1?"[]":""):void 0),form:p.form,value:f},a)]})});He.displayName=be;var ea="RadioBubbleInput",Be=g.forwardRef(({__scopeSlider:s,value:l,...r},a)=>{const d=g.useRef(null),o=ee(d,a),p=cs(l);return g.useEffect(()=>{const m=d.current;if(!m)return;const j=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(j,"value").set;if(p!==l&&u){const x=new Event("input",{bubbles:!0});u.call(m,l),m.dispatchEvent(x)}},[p,l]),e.jsx(ie.input,{style:{display:"none"},...r,ref:o,defaultValue:l})});Be.displayName=ea;function sa(s=[],l,r){const a=[...s];return a[r]=l,a.sort((d,o)=>d-o)}function $e(s,l,r){const o=100/(r-l)*(s-l);return Ae(o,[0,100])}function aa(s,l){return l>2?`Value ${s+1} of ${l}`:l===2?["Minimum","Maximum"][s]:void 0}function ta(s,l){if(s.length===1)return 0;const r=s.map(d=>Math.abs(d-l)),a=Math.min(...r);return r.indexOf(a)}function na(s,l,r){const a=s/2,o=Ne([0,50],[0,a]);return(a-o(l)*r)*r}function ra(s){return s.slice(0,-1).map((l,r)=>s[r+1]-l)}function ia(s,l){if(l>0){const r=ra(s);return Math.min(...r)>=l}return!0}function Ne(s,l){return r=>{if(s[0]===s[1]||l[0]===l[1])return l[0];const a=(l[1]-l[0])/(s[1]-s[0]);return l[0]+a*(r-s[0])}}function ca(s){return(String(s).split(".")[1]||"").length}function la(s,l){const r=Math.pow(10,l);return Math.round(s*r)/r}var Ke=Ie,oa=Fe,da=Ze,ma=He;const _e=g.forwardRef(({className:s,...l},r)=>e.jsxs(Ke,{ref:r,className:We("relative flex w-full touch-none select-none items-center",s),...l,children:[e.jsx(oa,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(da,{className:"absolute h-full bg-primary"})}),e.jsx(ma,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));_e.displayName=Ke.displayName;function ua({onFilterChange:s,onReset:l,onBulkAction:r}){const[a,d]=g.useState({search:"",severity:[],source:[],status:[],asset:[],subAsset:[],project:[],category:[],tenant:"all",perPage:20,currentPage:1,cvssRange:[0,10],dateRange:"all",assignee:[],hasCVE:!1,riskScore:[0,100],remediationPriority:[],complianceFrameworks:[]}),[o,p]=g.useState({search:!0,severity:!0,status:!0,source:!0,assets:!0,environment:!0,cvss:!1,risk:!1,date:!1,assignee:!1,remediation:!1,compliance:!1,advanced:!1}),m=(t,T)=>{const _=a[t],k=_.includes(T)?_.filter(V=>V!==T):[..._,T],i={...a,[t]:k,currentPage:1};d(i),s(i)},j=(t,T)=>{const _={...a,[t]:T,currentPage:1};d(_),s(_)},S=t=>{const T={...a,search:t,currentPage:1};d(T),s(T)},u=(t,T)=>{const _={...a,[t]:T,currentPage:1};d(_),s(_)},x=(t,T)=>{const _={...a,[t]:T,currentPage:1};d(_),s(_)},h=()=>{d({search:"",severity:[],source:[],status:[],asset:[],subAsset:[],project:[],category:[],tenant:"all",perPage:20,currentPage:1,cvssRange:[0,10],dateRange:"all",assignee:[],hasCVE:!1,riskScore:[0,100],remediationPriority:[],complianceFrameworks:[]}),l()},f=t=>{p(T=>({...T,[t]:!T[t]}))},N=a.severity.length+a.source.length+a.status.length+a.asset.length+a.subAsset.length+a.project.length+a.category.length+a.assignee.length+a.remediationPriority.length+a.complianceFrameworks.length+(a.search?1:0)+(a.tenant!=="all"?1:0)+(a.cvssRange[0]!==0||a.cvssRange[1]!==10?1:0)+(a.riskScore[0]!==0||a.riskScore[1]!==100?1:0)+(a.dateRange!=="all"?1:0)+(a.hasCVE?1:0),w=[{value:"Critical",label:"Critical",color:"destructive",count:7,icon:re},{value:"High",label:"High",color:"destructive",count:8,icon:Te},{value:"Medium",label:"Medium",color:"default",count:6,icon:re},{value:"Low",label:"Low",color:"secondary",count:3,icon:ne},{value:"Info",label:"Info",color:"secondary",count:1,icon:fe}],n=[{value:"open",label:"Open",icon:re,count:15,color:"destructive"},{value:"in_progress",label:"In Progress",icon:ve,count:6,color:"default"},{value:"fixed",label:"Fixed",icon:he,count:3,color:"secondary"},{value:"accepted",label:"Accepted",icon:he,count:1,color:"secondary"},{value:"ignored",label:"Ignored",icon:ge,count:0,color:"secondary"}],b=[{value:"snyk_sca",label:"Snyk SCA",count:6,icon:Ce},{value:"snyk_sast",label:"Snyk SAST",count:5,icon:Se},{value:"snyk_dast",label:"Snyk DAST",count:7,icon:ue},{value:"manual_vapt",label:"Manual VAPT",count:7,icon:fe},{value:"asset_scan",label:"Asset Scan",count:0,icon:F}],H=[{value:"prod-api-01",label:"Production API Server 01",count:5,icon:F},{value:"prod-api-02",label:"Production API Server 02",count:1,icon:F},{value:"web-server-02",label:"Web Server 02",count:1,icon:oe},{value:"db-primary",label:"Primary Database",count:1,icon:xe},{value:"staging-db",label:"Staging Database",count:1,icon:xe},{value:"auth-service",label:"Authentication Service",count:3,icon:ne},{value:"web-portal",label:"Web Portal",count:2,icon:oe},{value:"data-processor",label:"Data Processor",count:1,icon:F},{value:"load-balancer",label:"Load Balancer",count:1,icon:Hs},{value:"api-gateway",label:"API Gateway",count:2,icon:F},{value:"file-server",label:"File Server",count:1,icon:F},{value:"content-server",label:"Content Server",count:1,icon:F},{value:"admin-panel",label:"Admin Panel",count:1,icon:oe},{value:"reporting-service",label:"Reporting Service",count:1,icon:F},{value:"database-primary",label:"Database Primary",count:1,icon:xe},{value:"reporting-engine",label:"Reporting Engine",count:1,icon:F},{value:"token-service",label:"Token Service",count:1,icon:ne}],A=[{value:"all",label:"All Environments",count:25,icon:oe},{value:"production",label:"Production",count:8,icon:ke},{value:"staging",label:"Staging",count:1,icon:F},{value:"development",label:"Development",count:10,icon:Ce},{value:"testing",label:"Testing",count:6,icon:Se}],y=[{value:"john.doe@company.com",label:"John Doe",count:5},{value:"jane.smith@company.com",label:"Jane Smith",count:4},{value:"mike.wilson@company.com",label:"Mike Wilson",count:3},{value:"sarah.jones@company.com",label:"Sarah Jones",count:3},{value:"sam.wilson@company.com",label:"Sam Wilson",count:2}],$=[{value:"critical",label:"Critical Priority",count:5},{value:"high",label:"High Priority",count:8},{value:"medium",label:"Medium Priority",count:6},{value:"low",label:"Low Priority",count:3}],X=[{value:"soc2",label:"SOC 2",count:8},{value:"iso27001",label:"ISO 27001",count:6},{value:"gdpr",label:"GDPR",count:4},{value:"pci_dss",label:"PCI DSS",count:3},{value:"hipaa",label:"HIPAA",count:2}],G=[{value:"all",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"},{value:"quarter",label:"This Quarter"},{value:"year",label:"This Year"}];return e.jsxs("div",{className:"w-80 h-full overflow-y-auto bg-background border-r",children:[e.jsxs("div",{className:"sticky top-0 bg-background border-b p-4 z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4"}),e.jsx("h3",{className:"font-semibold text-lg",children:"Filters"}),N>0&&e.jsx(R,{variant:"secondary",className:"text-xs",children:N})]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:h,className:"text-xs",children:[e.jsx(ge,{className:"h-3 w-3 mr-1"}),"Reset"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(xs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ts,{placeholder:"Search vulnerabilities...",value:a.search,onChange:t=>S(t.target.value),className:"pl-10 h-10"})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(v,{children:e.jsxs(M,{open:o.severity,onOpenChange:()=>f("severity"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-destructive"}),e.jsx("span",{className:"font-medium",children:"Severity"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.severity?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-2",children:w.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{checked:a.severity.includes(t.value),onCheckedChange:()=>m("severity",t.value)}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.icon&&e.jsx(t.icon,{className:"h-3 w-3"}),e.jsx("span",{className:"text-sm",children:t.label})]}),e.jsx(R,{variant:"secondary",className:"text-xs",children:t.count})]})]},t.value))})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.status,onOpenChange:()=>f("status"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Status"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.status?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-2",children:n.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{checked:a.status.includes(t.value),onCheckedChange:()=>m("status",t.value)}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.icon&&e.jsx(t.icon,{className:"h-3 w-3"}),e.jsx("span",{className:"text-sm",children:t.label})]}),e.jsx(R,{variant:"secondary",className:"text-xs",children:t.count})]})]},t.value))})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.source,onOpenChange:()=>f("source"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Source"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.source?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-2",children:b.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{checked:a.source.includes(t.value),onCheckedChange:()=>m("source",t.value)}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.icon&&e.jsx(t.icon,{className:"h-3 w-3"}),e.jsx("span",{className:"text-sm",children:t.label})]}),e.jsx(R,{variant:"secondary",className:"text-xs",children:t.count})]})]},t.value))})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.assets,onOpenChange:()=>f("assets"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Assets"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.assets?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:H.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{checked:a.asset.includes(t.value),onCheckedChange:()=>m("asset",t.value)}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.icon&&e.jsx(t.icon,{className:"h-3 w-3"}),e.jsx("span",{className:"text-sm",children:t.label})]}),e.jsx(R,{variant:"secondary",className:"text-xs",children:t.count})]})]},t.value))})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.environment,onOpenChange:()=>f("environment"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"font-medium",children:"Environment"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.environment?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-2",children:A.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{checked:a.tenant===t.value,onCheckedChange:()=>u("tenant",t.value)}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.icon&&e.jsx(t.icon,{className:"h-3 w-3"}),e.jsx("span",{className:"text-sm",children:t.label})]}),e.jsx(R,{variant:"secondary",className:"text-xs",children:t.count})]})]},t.value))})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.cvss,onOpenChange:()=>f("cvss"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ks,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"font-medium",children:"CVSS Score Range"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.cvss?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Score Range"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.cvssRange[0]," - ",a.cvssRange[1]]})]}),e.jsx(_e,{value:a.cvssRange,onValueChange:t=>j("cvssRange",t),max:10,min:0,step:.1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0"}),e.jsx("span",{children:"10"})]})]})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.risk,onOpenChange:()=>f("risk"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"font-medium",children:"Risk Score"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.risk?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Risk Range"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.riskScore[0]," - ",a.riskScore[1]]})]}),e.jsx(_e,{value:a.riskScore,onValueChange:t=>j("riskScore",t),max:100,min:0,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Low"}),e.jsx("span",{children:"High"})]})]})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.date,onOpenChange:()=>f("date"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Date Range"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.date?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-4",children:e.jsxs(os,{value:a.dateRange,onValueChange:t=>u("dateRange",t),children:[e.jsx(ds,{className:"w-full",children:e.jsx(ms,{placeholder:"Select date range"})}),e.jsx(us,{children:G.map(t=>e.jsx(ps,{value:t.value,children:t.label},t.value))})]})})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.assignee,onOpenChange:()=>f("assignee"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Assignee"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.assignee?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-2",children:y.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{checked:a.assignee.includes(t.value),onCheckedChange:()=>m("assignee",t.value)}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsx("span",{className:"text-sm",children:t.label}),e.jsx(R,{variant:"secondary",className:"text-xs",children:t.count})]})]},t.value))})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.remediation,onOpenChange:()=>f("remediation"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"font-medium",children:"Remediation Priority"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.remediation?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-2",children:$.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{checked:a.remediationPriority.includes(t.value),onCheckedChange:()=>m("remediationPriority",t.value)}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsx("span",{className:"text-sm",children:t.label}),e.jsx(R,{variant:"secondary",className:"text-xs",children:t.count})]})]},t.value))})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.compliance,onOpenChange:()=>f("compliance"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Compliance Frameworks"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.compliance?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-2",children:X.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{checked:a.complianceFrameworks.includes(t.value),onCheckedChange:()=>m("complianceFrameworks",t.value)}),e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsx("span",{className:"text-sm",children:t.label}),e.jsx(R,{variant:"secondary",className:"text-xs",children:t.count})]})]},t.value))})})]})}),e.jsx(v,{children:e.jsxs(M,{open:o.advanced,onOpenChange:()=>f("advanced"),children:[e.jsx(E,{className:"w-full p-4 hover:bg-accent rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fs,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:"Advanced Options"})]}),e.jsx(L,{className:`h-4 w-4 transition-transform ${o.advanced?"rotate-180":""}`})]})}),e.jsx(I,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{checked:a.hasCVE,onCheckedChange:t=>x("hasCVE",t)}),e.jsx("span",{className:"text-sm",children:"Only show vulnerabilities with CVE IDs"})]})})})]})}),e.jsx(v,{children:e.jsxs(D,{className:"pt-6 space-y-3",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>r("export-pdf"),className:"w-full justify-start",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Export to PDF"]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>r("export-csv"),className:"w-full justify-start",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Export to CSV"]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>r("refresh"),className:"w-full justify-start",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Refresh Data"]})]})})]})]})}function pa({vulnerabilities:s,isLoading:l,onRowSelect:r,selectedVulns:a,onSelectChange:d}){const o=u=>{switch(u.toLowerCase()){case"critical":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"high":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";default:return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"}},p=u=>{switch(u.toLowerCase()){case"open":return"text-red-600 dark:text-red-400";case"in_progress":return"text-blue-600 dark:text-blue-400";case"fixed":return"text-green-600 dark:text-green-400";case"accepted":return"text-purple-600 dark:text-purple-400";case"ignored":return"text-gray-600 dark:text-gray-400";default:return"text-gray-600 dark:text-gray-400"}},m=u=>{switch(u){case"snyk_sca":return{label:"Snyk SCA",color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"};case"snyk_sast":return{label:"Snyk SAST",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"};case"snyk_dast":return{label:"Snyk DAST",color:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200"};case"manual_vapt":return{label:"Manual VAPT",color:"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200"};case"asset_scan":return{label:"Asset Scan",color:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200"};default:return{label:u,color:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}}},j=u=>{d(u?s.map(x=>x.id):[])},S=(u,x)=>{d(u?[...a,x]:a.filter(h=>h!==x))};return l?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading vulnerabilities..."})]})}):s.length===0?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground text-lg",children:"No vulnerabilities found"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"Try adjusting your filters or checking back later"})]})}):e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(Ns,{children:[e.jsx(Ss,{className:"bg-muted/50 dark:bg-muted/30",children:e.jsxs(we,{className:"hover:bg-muted/50 dark:hover:bg-muted/30",children:[e.jsx(K,{className:"w-12",children:e.jsx(Z,{checked:a.length>0&&a.length===s.length,onCheckedChange:j})}),e.jsx(K,{className:"text-foreground",children:"Title"}),e.jsx(K,{className:"text-foreground",children:"Source"}),e.jsx(K,{className:"text-foreground",children:"Severity"}),e.jsx(K,{className:"text-foreground",children:"CVSS"}),e.jsx(K,{className:"text-foreground",children:"Asset"}),e.jsx(K,{className:"text-foreground",children:"Status"}),e.jsx(K,{className:"text-foreground",children:"Due Date"}),e.jsx(K,{className:"w-12 text-foreground",children:"Actions"})]})}),e.jsx(ws,{children:s.map(u=>{const x=m(u.source);return e.jsxs(we,{className:`hover:bg-muted/50 dark:hover:bg-muted/30 transition-colors cursor-pointer ${a.includes(u.id)?"bg-accent":""}`,onClick:()=>r(u),children:[e.jsx(q,{onClick:h=>h.stopPropagation(),children:e.jsx(Z,{checked:a.includes(u.id),onCheckedChange:h=>S(h,u.id)})}),e.jsx(q,{className:"font-medium max-w-xs text-foreground",children:e.jsxs("div",{className:"truncate",title:u.title,children:[u.cve_id&&e.jsx("span",{className:"text-xs text-muted-foreground mr-2",children:u.cve_id}),u.title]})}),e.jsx(q,{children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${x.color}`,children:x.label})}),e.jsx(q,{children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${o(u.severity)}`,children:u.severity})}),e.jsx(q,{className:"text-foreground",children:e.jsx("span",{className:"font-semibold",children:u.cvss_score})}),e.jsx(q,{className:"text-sm text-foreground",children:u.asset_name}),e.jsx(q,{children:e.jsx("span",{className:`text-sm font-semibold capitalize ${p(u.status)}`,children:u.status.replace("_"," ")})}),e.jsx(q,{className:"text-sm text-foreground",children:new Date(u.date_due).toLocaleDateString()}),e.jsx(q,{onClick:h=>h.stopPropagation(),children:e.jsxs(hs,{children:[e.jsx(gs,{asChild:!0,children:e.jsx(C,{size:"sm",variant:"ghost",children:e.jsx(Is,{className:"h-4 w-4"})})}),e.jsxs(fs,{align:"end",children:[e.jsxs(Y,{children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(Y,{children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Export Report"]}),e.jsxs(Y,{children:[e.jsx($s,{className:"h-4 w-4 mr-2"}),"Add Comment"]}),e.jsxs(Y,{children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Mark as Fixed"]}),e.jsxs(Y,{children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Snooze"]}),e.jsxs(Y,{children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Escalate"]}),e.jsxs(Y,{children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Mark as False Positive"]}),e.jsxs(Y,{children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),"View in NVD"]})]})]})})]},u.id)})})]})})}function xa({activeTab:s,onTabChange:l,counts:r}){return e.jsx(Pe,{value:s,onValueChange:l,className:"w-full",children:e.jsxs(De,{className:"grid w-full grid-cols-6 lg:w-auto",children:[e.jsxs(W,{value:"all",className:"flex items-center gap-2",children:["All",e.jsx(R,{variant:"secondary",children:r.all})]}),e.jsxs(W,{value:"snyk_sca",className:"flex items-center gap-2",children:["SCA",e.jsx(R,{variant:"secondary",children:r.snyk_sca})]}),e.jsxs(W,{value:"snyk_sast",className:"flex items-center gap-2",children:["SAST",e.jsx(R,{variant:"secondary",children:r.snyk_sast})]}),e.jsxs(W,{value:"snyk_dast",className:"flex items-center gap-2",children:["DAST",e.jsx(R,{variant:"secondary",children:r.snyk_dast})]}),e.jsxs(W,{value:"manual_vapt",className:"flex items-center gap-2",children:["VAPT",e.jsx(R,{variant:"secondary",children:r.manual_vapt})]}),e.jsxs(W,{value:"asset_scan",className:"flex items-center gap-2",children:["Assets",e.jsx(R,{variant:"secondary",children:r.asset_scan})]})]})})}function ha({vulnerability:s,isOpen:l,onClose:r,onStatusChange:a}){if(!s)return null;const d=m=>{switch(m.toLowerCase()){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-blue-100 text-blue-800"}},p=(m=>({snyk_sca:{label:"Snyk SCA",color:"bg-purple-100 text-purple-800"},snyk_sast:{label:"Snyk SAST",color:"bg-blue-100 text-blue-800"},snyk_dast:{label:"Snyk DAST",color:"bg-indigo-100 text-indigo-800"},manual_vapt:{label:"Manual VAPT",color:"bg-amber-100 text-amber-800"},asset_scan:{label:"Asset Scan",color:"bg-cyan-100 text-cyan-800"}})[m]||{label:m,color:"bg-gray-100 text-gray-800"})(s.source);return e.jsx(vs,{open:l,onOpenChange:r,children:e.jsxs(js,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ys,{children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(bs,{className:"text-xl mb-2",children:[s.cve_id&&e.jsx("span",{className:"text-xs text-muted-foreground mr-2",children:s.cve_id}),s.title]}),e.jsx(_s,{className:"text-base",children:s.description})]}),e.jsx(C,{variant:"ghost",size:"sm",onClick:r,className:"h-8 w-8 p-0",children:e.jsx(ge,{className:"h-4 w-4"})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(v,{children:[e.jsx(z,{className:"pb-2",children:e.jsx(U,{className:"text-xs font-medium text-muted-foreground",children:"Severity"})}),e.jsx(D,{children:e.jsx(R,{className:d(s.severity),children:s.severity})})]}),e.jsxs(v,{children:[e.jsx(z,{className:"pb-2",children:e.jsx(U,{className:"text-xs font-medium text-muted-foreground",children:"CVSS Score"})}),e.jsx(D,{children:e.jsx("p",{className:"text-2xl font-bold",children:s.cvss_score})})]}),e.jsxs(v,{children:[e.jsx(z,{className:"pb-2",children:e.jsx(U,{className:"text-xs font-medium text-muted-foreground",children:"Source"})}),e.jsx(D,{children:e.jsx(R,{className:p.color,children:p.label})})]}),e.jsxs(v,{children:[e.jsx(z,{className:"pb-2",children:e.jsx(U,{className:"text-xs font-medium text-muted-foreground",children:"Status"})}),e.jsx(D,{children:e.jsx("p",{className:"text-sm font-semibold capitalize",children:s.status.replace("_"," ")})})]})]}),e.jsxs(Pe,{defaultValue:"details",className:"w-full",children:[e.jsxs(De,{children:[e.jsx(W,{value:"details",children:"Details"}),e.jsx(W,{value:"remediation",children:"Remediation"}),e.jsx(W,{value:"timeline",children:"Timeline"})]}),e.jsxs(pe,{value:"details",className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs(v,{children:[e.jsx(z,{children:e.jsx(U,{className:"text-sm",children:"Asset Information"})}),e.jsxs(D,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Asset Name"}),e.jsx("p",{className:"font-semibold",children:s.asset_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Asset Type"}),e.jsx("p",{className:"font-semibold",children:s.asset_type})]})]})]}),e.jsxs(v,{children:[e.jsx(z,{children:e.jsx(U,{className:"text-sm",children:"Dates"})}),e.jsxs(D,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Discovered"}),e.jsx("p",{className:"font-semibold",children:new Date(s.date_discovered).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Due Date"}),e.jsx("p",{className:"font-semibold",children:new Date(s.date_due).toLocaleDateString()})]})]})]})]}),s.affected_component&&e.jsxs(v,{children:[e.jsx(z,{children:e.jsx(U,{className:"text-sm",children:"Affected Component"})}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:s.affected_component}),s.affected_versions&&s.affected_versions.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Affected Versions"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.affected_versions.map(m=>e.jsx(R,{variant:"outline",children:m},m))})]})]})})]})]}),e.jsxs(pe,{value:"remediation",className:"space-y-4",children:[s.remediation?e.jsxs(v,{children:[e.jsx(z,{children:e.jsx(U,{className:"text-sm",children:"Remediation Steps"})}),e.jsx(D,{children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.remediation})})]}):e.jsx(v,{children:e.jsx(D,{className:"pt-6",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No remediation information available"})})}),s.recommendation&&e.jsxs(v,{children:[e.jsx(z,{children:e.jsx(U,{className:"text-sm",children:"Recommendation"})}),e.jsx(D,{children:e.jsx("p",{className:"text-sm",children:s.recommendation})})]}),s.reference_urls&&s.reference_urls.length>0&&e.jsxs(v,{children:[e.jsx(z,{children:e.jsx(U,{className:"text-sm",children:"References"})}),e.jsx(D,{children:e.jsx("ul",{className:"space-y-2",children:s.reference_urls.map((m,j)=>e.jsx("li",{children:e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline break-all",children:m})},j))})})]})]}),e.jsx(pe,{value:"timeline",className:"space-y-4",children:e.jsxs(v,{children:[e.jsx(z,{children:e.jsx(U,{className:"text-sm",children:"Status Changes"})}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-primary"}),e.jsx("div",{className:"w-0.5 h-12 bg-gray-200"})]}),e.jsxs("div",{className:"pb-4",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Discovered"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(s.date_discovered).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("div",{className:"h-3 w-3 rounded-full bg-gray-300"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold capitalize",children:["Current Status: ",s.status.replace("_"," ")]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date().toLocaleDateString()})]})]})]})})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{variant:"outline",onClick:()=>a(s.id,"in_progress"),disabled:s.status==="in_progress",children:"Mark In Progress"}),e.jsx(C,{variant:"outline",onClick:()=>a(s.id,"fixed"),disabled:s.status==="fixed",children:"Mark Fixed"}),e.jsx(C,{variant:"outline",onClick:()=>a(s.id,"accepted"),disabled:s.status==="accepted",children:"Accept Risk"})]})]})]})})}function ga(){const[s,l]=g.useState(!0),[r,a]=g.useState([]),[d,o]=g.useState([]),[p,m]=g.useState(null),[j,S]=g.useState(!1),[u,x]=g.useState("all"),[h,f]=g.useState("all"),[N,w]=g.useState(0),[n,b]=g.useState({search:"",severity:[],source:[],status:[],asset:[],subAsset:[],project:[],category:[],tenant:"all",perPage:20,currentPage:1,cvssRange:[0,10],dateRange:"all",assignee:[],hasCVE:!1,riskScore:[0,100],remediationPriority:[],complianceFrameworks:[]}),[H,A]=g.useState({all:0,snyk_sca:0,snyk_sast:0,snyk_dast:0,manual_vapt:0,asset_scan:0}),y=[{id:"VULN-001",title:"Remote Code Execution in Apache Log4j",description:"A critical vulnerability in Apache Log4j allows remote code execution through malicious input",severity:"Critical",cvss_score:10,cve_id:"CVE-2021-44228",source:"snyk_sca",source_label:"Snyk SCA",asset_id:1,asset_name:"prod-api-01",asset_type:"Server",sub_asset:"api-endpoint",project:"payments-platform",category:"appsec",status:"open",date_discovered:"2025-01-15T10:00:00Z",date_due:"2025-01-20T10:00:00Z",assignee:"john.doe@company.com",remediation:"Update Apache Log4j to version 2.17.0 or later",affected_component:"log4j-core",affected_versions:["2.0.0","2.1","2.6.1","2.7","2.8.1"],recommendation:"Immediately update to the latest patched version and test thoroughly",reference_urls:["https://nvd.nist.gov/vuln/detail/CVE-2021-44228","https://logging.apache.org/log4j/2.x/security-1.html"]},{id:"VULN-002",title:"Cross-Site Scripting (XSS) Vulnerability",description:"User input is not properly sanitized allowing XSS attacks",severity:"High",cvss_score:8.5,cve_id:"CVE-2025-0001",source:"snyk_sast",source_label:"Snyk SAST",asset_id:2,asset_name:"web-server-02",asset_type:"Server",sub_asset:"web-app",project:"user-management",category:"appsec",status:"in_progress",date_discovered:"2025-01-12T14:30:00Z",date_due:"2025-01-25T14:30:00Z",assignee:"jane.smith@company.com",remediation:"Implement input validation and output encoding",affected_component:"auth-module",recommendation:"Use content security policy (CSP) headers"},{id:"VULN-003",title:"SQL Injection in Login Form",description:"SQL queries are vulnerable to injection attacks",severity:"Critical",cvss_score:9.8,cve_id:"CVE-2025-0002",source:"manual_vapt",source_label:"Manual VAPT",asset_id:1,asset_name:"prod-api-01",asset_type:"Server",sub_asset:"api-endpoint",project:"payments-platform",category:"offsec",status:"open",date_discovered:"2025-01-10T09:15:00Z",date_due:"2025-01-18T09:15:00Z",assignee:"bob.wilson@company.com",remediation:"Use parameterized queries and prepared statements",affected_component:"login-handler",recommendation:"Implement ORM or use parameterized queries exclusively"},{id:"VULN-004",title:"Insecure Direct Object Reference (IDOR)",description:"Users can access resources they should not have access to",severity:"High",cvss_score:7.5,source:"snyk_dast",source_label:"Snyk DAST",asset_id:3,asset_name:"db-primary",asset_type:"Database",sub_asset:"database",project:"analytics",category:"appsec",status:"open",date_discovered:"2025-01-08T16:45:00Z",date_due:"2025-01-22T16:45:00Z",remediation:"Implement proper authorization checks for all resource access"},{id:"VULN-005",title:"Weak Cryptography - MD5 Hash",description:"Passwords are hashed using weak MD5 algorithm",severity:"High",cvss_score:8,source:"snyk_sca",source_label:"Snyk SCA",asset_id:4,asset_name:"auth-service",asset_type:"Service",sub_asset:"service",project:"user-management",category:"appsec",status:"fixed",date_discovered:"2025-01-05T11:20:00Z",date_due:"2025-01-15T11:20:00Z",remediation:"Switch to bcrypt, scrypt, or PBKDF2 for password hashing"},{id:"VULN-006",title:"Missing Security Headers",description:"HTTP security headers are not properly configured",severity:"Medium",cvss_score:6.5,source:"asset_scan",source_label:"Asset Scan",asset_id:2,asset_name:"web-server-02",asset_type:"Server",sub_asset:"web-app",project:"infrastructure",category:"infra",status:"open",date_discovered:"2025-01-07T13:30:00Z",date_due:"2025-01-28T13:30:00Z",remediation:"Add X-Frame-Options, X-Content-Type-Options, and other security headers"},{id:"VULN-007",title:"Outdated OpenSSL Version",description:"Server running vulnerable OpenSSL version with known CVEs",severity:"Critical",cvss_score:9.8,cve_id:"CVE-2022-0778",source:"snyk_sca",source_label:"Snyk SCA",asset_id:5,asset_name:"prod-api-02",asset_type:"Server",sub_asset:"service",project:"payments-platform",category:"appsec",status:"in_progress",date_discovered:"2025-01-16T09:00:00Z",date_due:"2025-01-20T09:00:00Z",assignee:"alice.johnson@company.com",remediation:"Update OpenSSL to version 3.0.3 or later",affected_component:"openssl-lib",affected_versions:["1.1.1","3.0.0","3.0.1","3.0.2"],recommendation:"Test thoroughly after update in staging environment"},{id:"VULN-008",title:"Privilege Escalation in API",description:"API endpoint allows privilege escalation through parameter manipulation",severity:"High",cvss_score:8.2,cve_id:"CVE-2025-0003",source:"manual_vapt",source_label:"Manual VAPT",asset_id:1,asset_name:"prod-api-01",asset_type:"Server",sub_asset:"api-endpoint",project:"payments-platform",category:"offsec",status:"open",date_discovered:"2025-01-14T15:45:00Z",date_due:"2025-01-21T15:45:00Z",assignee:"bob.wilson@company.com",remediation:"Implement proper role-based access control",affected_component:"user-roles-api",recommendation:"Audit all API endpoints for privilege escalation"},{id:"VULN-009",title:"Hardcoded Credentials in Config",description:"Database credentials found hardcoded in configuration files",severity:"Critical",cvss_score:9.5,source:"snyk_sast",source_label:"Snyk SAST",asset_id:6,asset_name:"staging-db",asset_type:"Database",sub_asset:"database",project:"user-management",category:"appsec",status:"fixed",date_discovered:"2025-01-11T11:20:00Z",date_due:"2025-01-17T11:20:00Z",assignee:"charlie.brown@company.com",remediation:"Remove hardcoded credentials and use environment variables",affected_component:"database-config",recommendation:"Rotate all exposed credentials immediately"},{id:"VULN-010",title:"Insufficient Logging",description:"Security events are not properly logged for audit trails",severity:"Medium",cvss_score:5.5,source:"manual_vapt",source_label:"Manual VAPT",asset_id:7,asset_name:"auth-service",asset_type:"Service",sub_asset:"service",project:"user-management",category:"compliance",status:"in_progress",date_discovered:"2025-01-13T14:00:00Z",date_due:"2025-01-27T14:00:00Z",assignee:"diana.prince@company.com",remediation:"Implement comprehensive security logging",affected_component:"authentication-logs",recommendation:"Follow OWASP logging recommendations"},{id:"VULN-011",title:"Open Redirect Vulnerability",description:"Application vulnerable to open redirect attacks",severity:"Medium",cvss_score:6.1,cve_id:"CVE-2025-0004",source:"snyk_dast",source_label:"Snyk DAST",asset_id:8,asset_name:"web-portal",asset_type:"Server",sub_asset:"web-app",project:"analytics",category:"appsec",status:"open",date_discovered:"2025-01-09T10:30:00Z",date_due:"2025-01-23T10:30:00Z",assignee:"eve.adams@company.com",remediation:"Validate and sanitize all redirect URLs",affected_component:"redirect-handler",recommendation:"Implement allowlist of safe redirect domains"},{id:"VULN-012",title:"Insecure Deserialization",description:"Application vulnerable to insecure deserialization attacks",severity:"Critical",cvss_score:9,cve_id:"CVE-2025-0005",source:"snyk_sast",source_label:"Snyk SAST",asset_id:9,asset_name:"data-processor",asset_type:"Service",sub_asset:"service",project:"analytics",category:"appsec",status:"open",date_discovered:"2025-01-17T16:15:00Z",date_due:"2025-01-24T16:15:00Z",assignee:"frank.miller@company.com",remediation:"Use secure serialization formats like JSON",affected_component:"data-parser",recommendation:"Implement input validation and integrity checks"},{id:"VULN-013",title:"Weak SSL Configuration",description:"SSL/TLS configuration allows weak ciphers and protocols",severity:"High",cvss_score:7.8,source:"asset_scan",source_label:"Asset Scan",asset_id:10,asset_name:"load-balancer",asset_type:"Infrastructure",sub_asset:"infrastructure",project:"infrastructure",category:"infra",status:"in_progress",date_discovered:"2025-01-12T12:00:00Z",date_due:"2025-01-26T12:00:00Z",assignee:"grace.kelly@company.com",remediation:"Update SSL configuration to disable weak ciphers",affected_component:"ssl-config",recommendation:"Follow PCI DSS SSL/TLS guidelines"},{id:"VULN-014",title:"Information Disclosure in Error Messages",description:"Error messages expose sensitive system information",severity:"Low",cvss_score:4,source:"snyk_dast",source_label:"Snyk DAST",asset_id:11,asset_name:"api-gateway",asset_type:"Server",sub_asset:"api-endpoint",project:"infrastructure",category:"appsec",status:"accepted",date_discovered:"2025-01-08T09:45:00Z",date_due:"2025-01-22T09:45:00Z",assignee:"henry.ford@company.com",remediation:"Customize error messages to remove sensitive information",affected_component:"error-handler",recommendation:"Use generic error messages for production"},{id:"VULN-015",title:"Missing Input Validation",description:"API endpoints lack proper input validation",severity:"High",cvss_score:8,cve_id:"CVE-2025-0006",source:"manual_vapt",source_label:"Manual VAPT",asset_id:12,asset_name:"user-service",asset_type:"Service",sub_asset:"service",project:"user-management",category:"offsec",status:"open",date_discovered:"2025-01-18T13:30:00Z",date_due:"2025-01-25T13:30:00Z",assignee:"iris.west@company.com",remediation:"Implement comprehensive input validation",affected_component:"api-input-validator",recommendation:"Use validation frameworks and sanitization libraries"},{id:"VULN-016",title:"Insecure File Upload",description:"File upload functionality allows arbitrary file types",severity:"High",cvss_score:8.5,cve_id:"CVE-2025-0007",source:"snyk_dast",source_label:"Snyk DAST",asset_id:13,asset_name:"file-server",asset_type:"Server",sub_asset:"web-app",project:"analytics",category:"appsec",status:"in_progress",date_discovered:"2025-01-15T11:00:00Z",date_due:"2025-01-22T11:00:00Z",assignee:"jack.bauer@company.com",remediation:"Implement strict file type validation and scanning",affected_component:"file-upload-handler",recommendation:"Scan all uploads for malware and restrict file types"},{id:"VULN-017",title:"Session Fixation Vulnerability",description:"Session IDs are not properly regenerated on login",severity:"Medium",cvss_score:6,source:"snyk_sast",source_label:"Snyk SAST",asset_id:14,asset_name:"auth-service",asset_type:"Service",sub_asset:"service",project:"user-management",category:"appsec",status:"fixed",date_discovered:"2025-01-10T14:20:00Z",date_due:"2025-01-17T14:20:00Z",assignee:"kate.ryan@company.com",remediation:"Regenerate session IDs on authentication",affected_component:"session-manager",recommendation:"Use secure session management practices"},{id:"VULN-018",title:"Directory Traversal Vulnerability",description:"Application vulnerable to directory traversal attacks",severity:"Critical",cvss_score:9.3,cve_id:"CVE-2025-0008",source:"manual_vapt",source_label:"Manual VAPT",asset_id:15,asset_name:"content-server",asset_type:"Server",sub_asset:"web-app",project:"analytics",category:"offsec",status:"open",date_discovered:"2025-01-19T10:15:00Z",date_due:"2025-01-26T10:15:00Z",assignee:"lucas.scott@company.com",remediation:"Validate and sanitize all file path inputs",affected_component:"file-access-handler",recommendation:"Use chroot jail and proper path validation"},{id:"VULN-019",title:"Insufficient Rate Limiting",description:"API endpoints lack proper rate limiting protection",severity:"Medium",cvss_score:5.8,source:"snyk_dast",source_label:"Snyk DAST",asset_id:16,asset_name:"api-gateway",asset_type:"Server",sub_asset:"api-endpoint",project:"infrastructure",category:"infra",status:"in_progress",date_discovered:"2025-01-16T08:30:00Z",date_due:"2025-01-30T08:30:00Z",assignee:"mia.anderson@company.com",remediation:"Implement rate limiting on all API endpoints",affected_component:"rate-limiter",recommendation:"Use token bucket algorithm with appropriate limits"},{id:"VULN-020",title:"Broken Authentication",description:"Authentication mechanism can be bypassed",severity:"Critical",cvss_score:9.8,cve_id:"CVE-2025-0009",source:"manual_vapt",source_label:"Manual VAPT",asset_id:17,asset_name:"admin-panel",asset_type:"Server",sub_asset:"web-app",project:"infrastructure",category:"offsec",status:"open",date_discovered:"2025-01-20T15:00:00Z",date_due:"2025-01-27T15:00:00Z",assignee:"noah.stone@company.com",remediation:"Fix authentication bypass vulnerability",affected_component:"auth-bypass",recommendation:"Implement multi-factor authentication"},{id:"VULN-021",title:"Insecure Direct Object Reference",description:"Users can access unauthorized resources through ID manipulation",severity:"High",cvss_score:7.5,source:"snyk_dast",source_label:"Snyk DAST",asset_id:18,asset_name:"reporting-service",asset_type:"Service",sub_asset:"service",project:"analytics",category:"appsec",status:"open",date_discovered:"2025-01-21T11:45:00Z",date_due:"2025-01-28T11:45:00Z",assignee:"olivia.taylor@company.com",remediation:"Implement proper authorization checks",affected_component:"resource-access",recommendation:"Use UUIDs instead of sequential IDs"},{id:"VULN-022",title:"Cross-Site Request Forgery",description:"Application vulnerable to CSRF attacks",severity:"Medium",cvss_score:6.1,cve_id:"CVE-2025-0010",source:"snyk_dast",source_label:"Snyk DAST",asset_id:19,asset_name:"web-portal",asset_type:"Server",sub_asset:"web-app",project:"user-management",category:"appsec",status:"in_progress",date_discovered:"2025-01-22T13:15:00Z",date_due:"2025-01-29T13:15:00Z",assignee:"peter.jones@company.com",remediation:"Implement CSRF tokens for all state-changing operations",affected_component:"form-handler",recommendation:"Use SameSite cookies and CSRF protection"},{id:"VULN-023",title:"Insecure Cryptographic Storage",description:"Sensitive data stored using weak encryption",severity:"High",cvss_score:8.2,source:"snyk_sast",source_label:"Snyk SAST",asset_id:20,asset_name:"database-primary",asset_type:"Database",sub_asset:"database",project:"payments-platform",category:"compliance",status:"open",date_discovered:"2025-01-23T09:30:00Z",date_due:"2025-01-30T09:30:00Z",assignee:"quinn.miller@company.com",remediation:"Implement strong encryption for sensitive data",affected_component:"data-encryption",recommendation:"Use AES-256 with proper key management"},{id:"VULN-024",title:"Server-Side Template Injection",description:"Template engine vulnerable to injection attacks",severity:"Critical",cvss_score:9.5,cve_id:"CVE-2025-0011",source:"manual_vapt",source_label:"Manual VAPT",asset_id:21,asset_name:"reporting-engine",asset_type:"Service",sub_asset:"service",project:"analytics",category:"offsec",status:"open",date_discovered:"2025-01-24T14:00:00Z",date_due:"2025-01-31T14:00:00Z",assignee:"rachel.green@company.com",remediation:"Sanitize all template inputs and use sandboxed templates",affected_component:"template-engine",recommendation:"Use template engines with built-in security features"},{id:"VULN-025",title:"Insecure Random Number Generation",description:"Application using predictable random number generator",severity:"Medium",cvss_score:5.9,source:"snyk_sast",source_label:"Snyk SAST",asset_id:22,asset_name:"token-service",asset_type:"Service",sub_asset:"service",project:"user-management",category:"appsec",status:"fixed",date_discovered:"2025-01-25T10:45:00Z",date_due:"2025-01-28T10:45:00Z",assignee:"sam.wilson@company.com",remediation:"Use cryptographically secure random number generator",affected_component:"token-generator",recommendation:"Use hardware security module for critical operations"}];g.useEffect(()=>{X()},[n,u,h]);const $=()=>e.jsxs("div",{className:"flex space-x-1 bg-muted p-1 rounded-lg",children:[e.jsx(C,{variant:h==="all"?"default":"ghost",size:"sm",onClick:()=>f("all"),className:"text-xs",children:"All Security"}),e.jsx(C,{variant:h==="offsec"?"default":"ghost",size:"sm",onClick:()=>f("offsec"),className:"text-xs",children:" OffSec"}),e.jsx(C,{variant:h==="appsec"?"default":"ghost",size:"sm",onClick:()=>f("appsec"),className:"text-xs",children:" AppSec"})]}),X=async()=>{try{l(!0);let i=[...y];if(h!=="all"&&(i=i.filter(c=>c.category===h)),n.search&&(i=i.filter(c=>c.title.toLowerCase().includes(n.search.toLowerCase())||c.cve_id?.toLowerCase().includes(n.search.toLowerCase()))),n.severity.length>0&&(i=i.filter(c=>n.severity.includes(c.severity))),n.source.length>0&&(i=i.filter(c=>n.source.includes(c.source))),n.status.length>0&&(i=i.filter(c=>n.status.includes(c.status))),n.asset.length>0&&(i=i.filter(c=>n.asset.includes(c.asset_name))),n.subAsset.length>0&&(i=i.filter(c=>c.sub_asset&&n.subAsset.includes(c.sub_asset))),n.project.length>0&&(i=i.filter(c=>c.project&&n.project.includes(c.project))),n.category.length>0&&(i=i.filter(c=>c.category&&n.category.includes(c.category))),n.cvssRange&&(n.cvssRange[0]>0||n.cvssRange[1]<10)&&(i=i.filter(c=>{const P=c.cvss_score||0;return P>=n.cvssRange[0]&&P<=n.cvssRange[1]})),n.riskScore&&(n.riskScore[0]>0||n.riskScore[1]<100)&&(i=i.filter(c=>{const P=(c.cvss_score||0)*10;return P>=n.riskScore[0]&&P<=n.riskScore[1]})),n.dateRange!=="all"){const c=new Date,P=new Date(c.getFullYear(),c.getMonth(),c.getDate());i=i.filter(ce=>{const le=new Date(ce.date_discovered);if(n.dateRange==="today")return le>=P;if(n.dateRange==="week"){const te=new Date(P.getTime()-6048e5);return le>=te}else if(n.dateRange==="month"){const te=new Date(P.getTime()-2592e6);return le>=te}else if(n.dateRange==="quarter"){const te=new Date(P.getTime()-7776e6);return le>=te}return!0})}n.assignee.length>0&&(i=i.filter(c=>n.assignee.includes("unassigned")?!c.assignee||n.assignee.includes(c.assignee):c.assignee&&n.assignee.includes(c.assignee))),n.hasCVE&&(i=i.filter(c=>c.cve_id)),n.tenant!=="all"&&(i=i.filter(c=>n.tenant==="production"?c.asset_name.includes("prod")||c.asset_name.includes("production"):n.tenant==="staging"?c.asset_name.includes("staging")||c.asset_name.includes("stage"):n.tenant==="development"?c.asset_name.includes("dev")||c.project==="analytics"||c.project==="user-management":n.tenant==="testing"?c.asset_name.includes("test")||c.asset_name.includes("testing"):!0));const V=(n.currentPage-1)*n.perPage,B=V+n.perPage,ae=i.slice(V,B);a(ae);const J=i.length;w(J),A({all:y.length,snyk_sca:y.filter(c=>c.source==="snyk_sca").length,snyk_sast:y.filter(c=>c.source==="snyk_sast").length,snyk_dast:y.filter(c=>c.source==="snyk_dast").length,manual_vapt:y.filter(c=>c.source==="manual_vapt").length,asset_scan:y.filter(c=>c.source==="asset_scan").length})}catch(i){console.error("Failed to fetch vulnerabilities:",i)}finally{l(!1)}},G=i=>{m(i),S(!0)},t=async(i,V)=>{try{a(r.map(B=>B.id===i?{...B,status:V}:B)),m(p?.id===i?{...p,status:V}:p),console.log(`Updated ${i} to ${V}`)}catch(B){console.error("Failed to update vulnerability:",B)}},T=async()=>{try{console.log("Exporting vulnerabilities...")}catch(i){console.error("Export failed:",i)}},_=async i=>{try{switch(console.log(`Bulk action: ${i}`,d),i){case"clear-selection":o([]);break;case"mark-in-progress":console.log("Marking vulnerabilities as in progress:",d);break;case"mark-fixed":console.log("Marking vulnerabilities as fixed:",d);break;case"assign":console.log("Assigning vulnerabilities:",d);break;case"delete":console.log("Deleting vulnerabilities:",d);break;case"export-pdf":console.log("Exporting to PDF...");break;case"export-csv":console.log("Exporting to CSV...");break;case"export-json":console.log("Exporting to JSON...");break;case"refresh":console.log("Refreshing data..."),X();break;default:console.log("Unknown action:",i)}}catch(V){console.error("Bulk action failed:",V)}},k=i=>{b({...n,currentPage:i})};return e.jsxs(e.Fragment,{children:[e.jsxs(Ge,{children:[e.jsx(es,{links:fa}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(Je,{}),e.jsx(as,{}),e.jsx(Ye,{}),e.jsx(ss,{})]})]}),e.jsxs(Qe,{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Vulnerabilities"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage and track all security vulnerabilities across your infrastructure"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(C,{variant:"outline",size:"sm",onClick:T,className:"gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Export"]})})]}),e.jsx(v,{className:"mb-4",children:e.jsx(D,{className:"pt-6",children:e.jsx(xa,{activeTab:u,onTabChange:x,counts:H})})}),e.jsxs("div",{className:"flex h-[calc(100vh-200px)]",children:[e.jsx("div",{className:"w-80 h-full overflow-y-auto border-r bg-background",children:e.jsx(ua,{onFilterChange:b,onReset:()=>b({search:"",severity:[],source:[],status:[],asset:[],subAsset:[],project:[],category:[],tenant:"all",perPage:20,currentPage:1,cvssRange:[0,10],dateRange:"all",assignee:[],hasCVE:!1,riskScore:[0,100],remediationPriority:[],complianceFrameworks:[]}),onBulkAction:_})}),e.jsx("div",{className:"flex-1 h-full overflow-y-auto",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(v,{children:e.jsx(D,{className:"pt-6",children:e.jsx($,{})})}),d.length>0&&e.jsx(v,{className:"border-blue-200 bg-blue-50",children:e.jsxs(D,{className:"pt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm font-semibold",children:[d.length," vulnerabilities selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{size:"sm",variant:"outline",onClick:()=>_("mark_progress"),children:"Mark In Progress"}),e.jsx(C,{size:"sm",variant:"outline",onClick:()=>_("mark_fixed"),children:"Mark Fixed"}),e.jsx(C,{size:"sm",variant:"outline",onClick:()=>_("assign"),children:"Assign To"}),e.jsx(C,{size:"sm",variant:"destructive",onClick:()=>o([]),children:"Clear Selection"})]})]})}),e.jsxs(v,{className:"flex-1",children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(U,{children:[r.length," Vulnerabilit",r.length!==1?"ies":"y"," Found"]}),e.jsxs(Xe,{children:["Page ",n.currentPage," of ",Math.ceil(N/n.perPage)," (Total: ",N," filtered from ",y.length,")"]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Filtered: ",N," | Showing: ",(n.currentPage-1)*n.perPage+1,"-",Math.min(n.currentPage*n.perPage,N)]})]})}),e.jsx(D,{className:"p-0",children:e.jsx("div",{className:"h-[600px] overflow-auto",children:e.jsx(pa,{vulnerabilities:r,isLoading:s,onRowSelect:G,selectedVulns:d,onSelectChange:o})})})]}),e.jsx(v,{children:e.jsx(D,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",r.length," of ",N," vulnerabilities"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:()=>k(n.currentPage-1),disabled:n.currentPage===1,children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.ceil(N/n.perPage)},(i,V)=>V+1).map(i=>e.jsx(C,{variant:n.currentPage===i?"default":"outline",size:"sm",onClick:()=>k(i),className:"w-8 h-8 p-0",children:i},i))}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>k(n.currentPage+1),disabled:n.currentPage===Math.ceil(N/n.perPage),children:"Next"})]})]})})})]})})]})]}),e.jsx(ha,{vulnerability:p,isOpen:j,onClose:()=>S(!1),onStatusChange:t})]})}const fa=[{title:"Overview",href:"/",isActive:!0,disabled:!1},{title:"Vulnerabilities",href:"/vulnerabilities",isActive:!0,disabled:!1},{title:"Assets",href:"/assets",isActive:!0,disabled:!1},{title:"Compliance",href:"/compliance",isActive:!1,disabled:!0}],Qa=ga;export{Qa as component};
