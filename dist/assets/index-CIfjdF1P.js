import{c as he,r as u,j as e,U as je,B as o}from"./index-D5yFZTJT.js";import{C as i,a as r,b as c,c as l,d as w}from"./card-_C5rOst6.js";import{B as m}from"./badge-BxzTBBTM.js";import{A as ue,b as pe}from"./alert-DMCiiJg_.js";import{T as re,a as ce,b as V,c as B}from"./tabs-4ufR05Dk.js";import{S as D,a as R,b as P,c as F,d as x}from"./select-DlNyGPge.js";import{C as K}from"./config-drawer-DLKo-OYb.js";import{H as G,S as X}from"./search-4USrNPqQ.js";import{M as Y}from"./main-DSllam1x.js";import{P as W}from"./profile-dropdown-ChTwtDjd.js";import{T as J}from"./theme-switch-CmNwWpIK.js";import{T as ge,a as fe,b as Z,c as f,d as ve,e as v}from"./table-yNXmnKzn.js";import{E as Ne,F as ye,G as be,H as Se,I as we}from"./confirm-dialog-zKhKn28L.js";import{T as de}from"./scroll-area-DXrIRKGR.js";import{C as Ce}from"./calendar-Cd3YCyv9.js";import{E as ee}from"./external-link-DLUFKc79.js";import{C as se,D as oe,P as ke,a as Te,b as Ae,B as Ie,c as De}from"./PieChart-cCC2fx0O.js";import{T as $}from"./triangle-alert-V9xPiE56.js";import{C as T}from"./circle-check-big-CgNhaSX9.js";import{C as M}from"./clock-BXpLLm5f.js";import{C as xe}from"./circle-x-Dbhi9AAb.js";import{A as Re}from"./arrow-left-kyP3S-jp.js";import{R as ae,T as te,C as Pe,X as Fe,Y as Ve}from"./CartesianChart-Cplh--nX.js";import{E as ie}from"./eye-rco7DweG.js";import{P as le}from"./play-Bdg8LfgE.js";import{C as Be}from"./chart-column-BvqxwflC.js";import{C as Me}from"./circle-alert-Ck3_ULD2.js";import"./index-ct4H7l3c.js";import"./index-vaCEiu-o.js";import"./index-B51JH_D_.js";import"./index-HMuv4Vdv.js";import"./index-BnQUeaZ4.js";import"./index-C7K6Hpgd.js";import"./index-ChjqkuDX.js";import"./index-DOet6U1O.js";import"./index-8jwYIEgM.js";import"./check-rv3POfwq.js";import"./index-DuUIxtzR.js";import"./layout-provider-CabReZxa.js";import"./rotate-ccw-waMw_Jb3.js";import"./circle-check-CtYxKmvF.js";import"./separator-ioKrCfVc.js";import"./sign-out-dialog-CQ1qtIeu.js";import"./circle-question-mark-niS6VXsW.js";import"./arrow-right-DA9g1Hyg.js";import"./graphicalItemSelectors-ebohmsXb.js";const Oe=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],U=he("refresh-cw",Oe),Le={Critical:"destructive",High:"destructive",Medium:"default",Low:"secondary"},He={Open:"destructive","In Progress":"default",Fixed:"default","Risk Accepted":"secondary"},ze={Open:e.jsx(xe,{className:"w-4 h-4"}),"In Progress":e.jsx(M,{className:"w-4 h-4"}),Fixed:e.jsx(T,{className:"w-4 h-4"}),"Risk Accepted":e.jsx($,{className:"w-4 h-4"})};function Ee({vulnerability:t,isOpen:A,onClose:p}){const[I,N]=u.useState(!1),y=d=>{navigator.clipboard.writeText(d),N(!0),setTimeout(()=>N(!1),2e3)},C=d=>e.jsx(m,{variant:Le[d]||"secondary",children:d}),g=d=>e.jsxs(m,{variant:He[d]||"secondary",className:"flex items-center gap-1",children:[ze[d],d]});return t?e.jsx(Ne,{open:A,onOpenChange:p,children:e.jsxs(ye,{className:"w-screen max-h-[90vh] overflow-y-auto",children:[e.jsxs(be,{children:[e.jsx(Se,{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[C(t.severity),g(t.status)]}),e.jsx("h2",{className:"text-xl font-bold",children:t.vulnerabilityTitle}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono mt-1",children:t.vulnerabilityId})]})}),e.jsx(we,{children:"Detailed vulnerability information and remediation guidance"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(i,{children:[e.jsx(r,{className:"pb-3",children:e.jsxs(c,{className:"text-base flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"Target Information"]})}),e.jsxs(l,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Target:"}),e.jsx("span",{className:"text-sm",children:t.target})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Branch:"}),e.jsx("span",{className:"text-sm font-mono",children:t.targetedBranch})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Instances:"}),e.jsx("span",{className:"text-sm",children:t.instances})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Assessment Type:"}),e.jsx("span",{className:"text-sm",children:t.assessmentType})]})]})]}),e.jsxs(i,{children:[e.jsx(r,{className:"pb-3",children:e.jsxs(c,{className:"text-base flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4"}),"Responsibility & Status"]})}),e.jsxs(l,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Responsible Team:"}),e.jsx("span",{className:"text-sm",children:t.responsibleTeam})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Current Status:"}),g(t.status)]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Risk Level:"}),e.jsx("span",{className:"text-sm",children:t.risk})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Risk Accepted:"}),e.jsx("span",{className:"text-sm",children:t.riskAcceptance?"Yes":"No"})]})]})]})]}),e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"Vulnerability Details"})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:t.description})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Category"}),e.jsx(m,{variant:"outline",children:t.category})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Recommendation"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed bg-blue-50 dark:bg-blue-950 p-3 rounded-lg",children:t.recommendation})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Remarks"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:t.remarks})]})]})]}),e.jsxs(i,{children:[e.jsx(r,{children:e.jsxs(c,{className:"text-base flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Timeline Information"]})}),e.jsx(l,{className:"space-y-3",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Discovery Date:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Fix Date:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.fixDate||"Not fixed yet"})]})]})})]}),e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"References"})}),e.jsxs(l,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"CVE ID:"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-sm font-mono text-muted-foreground",children:t.cveId||"No CVE assigned"}),t.cveId&&e.jsx(o,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>window.open(t.reference,"_blank"),children:e.jsx(ee,{className:"w-3 h-3"})}),e.jsx(o,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>y(t.cveId||t.vulnerabilityId),children:e.jsx(se,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Additional Reference:"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground truncate",children:t.reference}),e.jsx(o,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>window.open(t.reference,"_blank"),children:e.jsx(ee,{className:"w-3 h-3"})}),e.jsx(o,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>y(t.reference),children:e.jsx(se,{className:"w-3 h-3"})})]})]}),I&&e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400",children:"Copied to clipboard!"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(o,{variant:"outline",onClick:p,children:"Close"}),e.jsx(o,{children:"Create Jira Ticket"})]})]})]})}):null}const j=[{id:1,date:"2024-01-18",vulnerabilityId:"SAST-001",cveId:"CVE-2024-1234",instances:1,assessmentType:"SAST",target:"API Backend - auth.service.ts",vulnerabilityTitle:"SQL Injection in Authentication Service",severity:"Critical",targetedBranch:"main",category:"Injection",description:"The authentication service contains a SQL injection vulnerability in the login function where user input is directly concatenated into SQL queries without proper sanitization.",risk:"High - Complete database compromise possible",recommendation:"Use parameterized queries or prepared statements to prevent SQL injection. Implement input validation and sanitization.",responsibleTeam:"Backend Team",status:"Open",source:"Snyk Code",fixDate:null,riskAcceptance:!1,remarks:"Requires immediate attention as this affects authentication mechanism",reference:"https://owasp.org/www-community/attacks/SQL_Injection"},{id:2,date:"2024-01-18",vulnerabilityId:"SCA-001",cveId:"CVE-2024-5678",instances:3,assessmentType:"SCA",target:"Frontend App - package.json dependencies",vulnerabilityTitle:"Vulnerable NPM Package - lodash < 4.17.21",severity:"High",targetedBranch:"main",category:"Dependency",description:"The project uses an outdated version of lodash which contains known security vulnerabilities that could lead to prototype pollution attacks.",risk:"Medium - Potential prototype pollution and DoS attacks",recommendation:"Update lodash to version 4.17.21 or later. Consider using alternative libraries if possible.",responsibleTeam:"Frontend Team",status:"In Progress",source:"Snyk Open Source",fixDate:"2024-01-20",riskAcceptance:!1,remarks:"Scheduled for next sprint deployment",reference:"https://nvd.nist.gov/vuln/detail/CVE-2024-5678"},{id:3,date:"2024-01-18",vulnerabilityId:"CONT-001",cveId:"CVE-2024-9012",instances:1,assessmentType:"Container",target:"Docker Image - nginx:1.19-alpine",vulnerabilityTitle:"Outdated Nginx Container Image",severity:"Medium",targetedBranch:"main",category:"Container",description:"The nginx container image is running version 1.19 which has known security vulnerabilities and is no longer supported.",risk:"Low - Potential for known vulnerabilities in web server",recommendation:"Update nginx container to the latest stable version (1.25+). Implement regular container image updates.",responsibleTeam:"DevOps Team",status:"Fixed",source:"Snyk Container",fixDate:"2024-01-19",riskAcceptance:!1,remarks:"Updated in production",reference:"https://nginx.org/en/security_advisories.html"},{id:4,date:"2024-01-18",vulnerabilityId:"SAST-002",cveId:null,instances:2,assessmentType:"SAST",target:"API Backend - user.controller.ts",vulnerabilityTitle:"Hardcoded API Keys in Source Code",severity:"High",targetedBranch:"main",category:"Security Misconfiguration",description:"API keys and database credentials are hardcoded directly in the source code, which poses a significant security risk.",risk:"High - Unauthorized access to external services and database",recommendation:"Move all credentials to environment variables or secure secret management systems. Never commit secrets to version control.",responsibleTeam:"Backend Team",status:"Open",source:"Snyk Code",fixDate:null,riskAcceptance:!1,remarks:"Critical for production security",reference:"https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication"}],z={Critical:"#dc2626",High:"#ea580c",Medium:"#ca8a04",Low:"#0ea5e9"},E={Open:"#dc2626","In Progress":"#ca8a04",Fixed:"#16a34a","Risk Accepted":"#6b7280"};function Ue({scanId:t,onBack:A}){const[p,I]=u.useState("overview"),[N,y]=u.useState(null),[C,g]=u.useState(!1),d={total:j.length,critical:j.filter(a=>a.severity==="Critical").length,high:j.filter(a=>a.severity==="High").length,medium:j.filter(a=>a.severity==="Medium").length,low:j.filter(a=>a.severity==="Low").length,open:j.filter(a=>a.status==="Open").length,inProgress:j.filter(a=>a.status==="In Progress").length,fixed:j.filter(a=>a.status==="Fixed").length,riskAccepted:j.filter(a=>a.status==="Risk Accepted").length},k=[{name:"Critical",value:d.critical,color:z.Critical},{name:"High",value:d.high,color:z.High},{name:"Medium",value:d.medium,color:z.Medium},{name:"Low",value:d.low,color:z.Low}].filter(a=>a.value>0),n=[{name:"Open",value:d.open,color:E.Open},{name:"In Progress",value:d.inProgress,color:E["In Progress"]},{name:"Fixed",value:d.fixed,color:E.Fixed},{name:"Risk Accepted",value:d.riskAccepted,color:E["Risk Accepted"]}],O=a=>{const h={Critical:"destructive",High:"destructive",Medium:"default",Low:"secondary"};return e.jsx(m,{variant:h[a]||"secondary",children:a})},_=a=>{const h={Open:"destructive","In Progress":"default",Fixed:"default","Risk Accepted":"secondary"},Q={Open:e.jsx(xe,{className:"w-3 h-3"}),"In Progress":e.jsx(M,{className:"w-3 h-3"}),Fixed:e.jsx(T,{className:"w-3 h-3"}),"Risk Accepted":e.jsx($,{className:"w-3 h-3"})};return e.jsxs(m,{variant:h[a]||"secondary",className:"flex items-center gap-1",children:[Q[a],a]})},L=a=>{y(a),g(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(o,{variant:"ghost",onClick:A,className:"flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Back to Scans"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Scan Results - SCAN-001"}),e.jsx("p",{className:"text-muted-foreground",children:"SAST Analysis - API Backend"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),"Completed"]}),e.jsxs(o,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),"Export Report"]}),e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Re-scan"]})]})]}),e.jsxs(re,{value:p,onValueChange:I,children:[e.jsxs(ce,{className:"grid w-full grid-cols-2",children:[e.jsx(V,{value:"overview",children:"Overview"}),e.jsx(V,{value:"vulnerabilities",children:"Vulnerabilities"})]}),e.jsxs(B,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(i,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Vulnerabilities"}),e.jsx(de,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Found in this scan"})]})]}),e.jsxs(i,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Critical Issues"}),e.jsx($,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.critical}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Require immediate action"})]})]}),e.jsxs(i,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Fixed Issues"}),e.jsx(T,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.fixed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully resolved"})]})]}),e.jsxs(i,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"In Progress"}),e.jsx(M,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:d.inProgress}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently being addressed"})]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(c,{children:"Severity Distribution"}),e.jsx(w,{children:"Vulnerabilities by severity level"})]}),e.jsx(l,{children:e.jsx(ae,{width:"100%",height:300,children:e.jsxs(ke,{children:[e.jsx(Te,{data:k,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:h})=>`${a}: ${((h||0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:k.map((a,h)=>e.jsx(Ae,{fill:a.color},`cell-${h}`))}),e.jsx(te,{})]})})})]}),e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(c,{children:"Status Overview"}),e.jsx(w,{children:"Vulnerabilities by current status"})]}),e.jsx(l,{children:e.jsx(ae,{width:"100%",height:300,children:e.jsxs(Ie,{data:n,children:[e.jsx(Pe,{strokeDasharray:"3 3"}),e.jsx(Fe,{dataKey:"name"}),e.jsx(Ve,{}),e.jsx(te,{}),e.jsx(De,{dataKey:"value",fill:"#8884d8"})]})})})]})]})]}),e.jsx(B,{value:"vulnerabilities",className:"space-y-6",children:e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(c,{children:"Vulnerability Details"}),e.jsx(w,{children:"Complete list of identified vulnerabilities"})]}),e.jsx(l,{children:e.jsxs(ge,{children:[e.jsx(fe,{children:e.jsxs(Z,{children:[e.jsx(f,{children:"ID"}),e.jsx(f,{children:"Date"}),e.jsx(f,{children:"Title"}),e.jsx(f,{children:"Severity"}),e.jsx(f,{children:"Status"}),e.jsx(f,{children:"Target"}),e.jsx(f,{children:"Team"}),e.jsx(f,{children:"Actions"})]})}),e.jsx(ve,{children:j.map(a=>e.jsxs(Z,{children:[e.jsx(v,{className:"font-mono text-xs",children:a.vulnerabilityId}),e.jsx(v,{className:"text-xs",children:a.date}),e.jsx(v,{className:"max-w-xs truncate",title:a.vulnerabilityTitle,children:a.vulnerabilityTitle}),e.jsx(v,{children:O(a.severity)}),e.jsx(v,{children:_(a.status)}),e.jsx(v,{className:"text-xs",children:a.target}),e.jsx(v,{className:"text-xs",children:a.responsibleTeam}),e.jsx(v,{children:e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>L(a),children:"View Details"})})]},a.id))})]})})]})})]}),e.jsx(Ee,{vulnerability:N,isOpen:C,onClose:()=>g(!1)})]})}const S=[{id:"SCAN-001",type:"SAST",tool:"Snyk Code",project:"API Backend",startTime:"2024-01-18 14:30",endTime:"2024-01-18 14:45",duration:"15 min",status:"completed",issues:{critical:2,high:5,medium:12,low:8}},{id:"SCAN-002",type:"SCA",tool:"Snyk Open Source",project:"Frontend App",startTime:"2024-01-18 13:15",endTime:"2024-01-18 13:28",duration:"13 min",status:"completed",issues:{critical:0,high:3,medium:8,low:12}},{id:"SCAN-003",type:"Container",tool:"Snyk Container",project:"Docker Images",startTime:"2024-01-18 12:00",endTime:"2024-01-18 12:22",duration:"22 min",status:"completed",issues:{critical:1,high:2,medium:5,low:3}},{id:"SCAN-004",type:"SAST",tool:"Snyk Code",project:"Microservices",startTime:"2024-01-18 15:00",endTime:null,duration:"5 min",status:"scanning",issues:null}],ne=[{id:"sast",name:"SAST - Static Code Analysis"},{id:"sca",name:"SCA - Software Composition Analysis"},{id:"container",name:"Container - Container Scanning"},{id:"dast",name:"DAST - Dynamic Application Security"}],_e=[{id:"api-backend",name:"API Backend"},{id:"frontend-app",name:"Frontend App"},{id:"docker-images",name:"Docker Images"},{id:"microservices",name:"Microservices"},{id:"mobile-app",name:"Mobile App"},{id:"web-portal",name:"Web Portal"},{id:"admin-panel",name:"Admin Panel"},{id:"api-gateway",name:"API Gateway"},{id:"auth-service",name:"Authentication Service"},{id:"payment-service",name:"Payment Service"},{id:"notification-service",name:"Notification Service"},{id:"analytics-service",name:"Analytics Service"},{id:"user-service",name:"User Service"},{id:"order-service",name:"Order Service"},{id:"inventory-service",name:"Inventory Service"}];function Qe(){const[t,A]=u.useState(null),[p,I]=u.useState(null),[N,y]=u.useState(!1),[C,g]=u.useState(null),[d,k]=u.useState("overview"),[n,O]=u.useState({scanType:"all",status:"all",severity:"all",dateRange:"all"}),_=()=>{if(!t||!p){alert("Please select a scan type and project");return}y(!0),setTimeout(()=>{y(!1),alert("Scan initiated successfully!")},2e3)},L=s=>{g(s)},a=()=>{g(null)},h=(s,q)=>{O(me=>({...me,[s]:q}))},Q=()=>{O({scanType:"all",status:"all",severity:"all",dateRange:"all"})},H=S.filter(s=>!(n.scanType!=="all"&&s.type.toLowerCase()!==n.scanType||n.status!=="all"&&s.status!==n.status||n.severity!=="all"&&(!s.issues||n.severity==="critical"&&s.issues.critical===0||n.severity==="high"&&s.issues.high===0||n.severity==="medium"&&s.issues.medium===0||n.severity==="low"&&s.issues.low===0))),b={totalScans:S.length,activeScans:S.filter(s=>s.status==="scanning").length,criticalIssues:S.reduce((s,q)=>s+(q.issues?.critical||0),0),resolvedIssues:18,applicationsScanned:8,avgScanTime:"16 min",scanSuccessRate:"95%"};return C?e.jsxs(e.Fragment,{children:[e.jsxs(G,{fixed:!0,children:[e.jsx(X,{}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(J,{}),e.jsx(K,{}),e.jsx(W,{})]})]}),e.jsx(Y,{className:"flex flex-1 flex-col gap-6",children:e.jsx(Ue,{scanId:C,onBack:a})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(G,{fixed:!0,children:[e.jsx(X,{}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(J,{}),e.jsx(K,{}),e.jsx(W,{})]})]}),e.jsxs(Y,{className:"flex flex-1 flex-col gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Application Security Scans"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor security scans and manage application vulnerabilities"})]}),e.jsxs(re,{value:d,onValueChange:k,children:[e.jsxs(ce,{className:"grid w-full grid-cols-3",children:[e.jsx(V,{value:"overview",children:"Overview"}),e.jsx(V,{value:"initiate-scan",children:"Initiate Scan"}),e.jsx(V,{value:"reports",children:"Reports"})]}),e.jsx(B,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-4",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(i,{children:e.jsxs(l,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:b.totalScans}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Scans"})]})}),e.jsx(i,{children:e.jsxs(l,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:b.criticalIssues}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Critical Issues"})]})}),e.jsx(i,{children:e.jsxs(l,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:b.activeScans}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Scans"})]})}),e.jsx(i,{children:e.jsxs(l,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:b.resolvedIssues}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Resolved Issues"})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"Applications Scanned"})}),e.jsxs(l,{children:[e.jsx("div",{className:"text-3xl font-bold",children:b.applicationsScanned}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total applications"})]})]}),e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"Avg Scan Time"})}),e.jsxs(l,{children:[e.jsx("div",{className:"text-3xl font-bold",children:b.avgScanTime}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Per scan"})]})]}),e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"Success Rate"})}),e.jsxs(l,{children:[e.jsx("div",{className:"text-3xl font-bold",children:b.scanSuccessRate}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scan completion"})]})]})]}),e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(c,{className:"text-base",children:"Recent Scans"}),e.jsx(w,{className:"text-xs",children:"Click to view detailed scan results"})]}),e.jsx(l,{children:e.jsx("div",{className:"space-y-3",children:S.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-accent transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[s.status==="completed"?e.jsx(T,{className:"w-5 h-5 text-green-600"}):e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.tool}),e.jsx(m,{variant:"outline",className:"text-xs",children:s.type}),s.status==="scanning"&&e.jsxs(m,{variant:"secondary",className:"text-xs",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),"Scanning..."]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:[s.project," • ",s.duration]}),s.status==="completed"&&s.issues&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[s.issues.critical>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-red-100 dark:bg-red-950 text-red-700 dark:text-red-200 rounded",children:["C: ",s.issues.critical]}),s.issues.high>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-orange-100 dark:bg-orange-950 text-orange-700 dark:text-orange-200 rounded",children:["H: ",s.issues.high]}),s.issues.medium>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-yellow-100 dark:bg-yellow-950 text-yellow-700 dark:text-yellow-200 rounded",children:["M: ",s.issues.medium]}),s.issues.low>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-950 text-blue-700 dark:text-blue-200 rounded",children:["L: ",s.issues.low]})]})]})]}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>L(s.id),children:e.jsx(ie,{className:"w-4 h-4"})})]},s.id))})})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"Quick Actions"})}),e.jsxs(l,{className:"space-y-2",children:[e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>k("initiate-scan"),children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"New Scan"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>k("reports"),children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"View All Reports"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Schedule Scans"]}),e.jsx("div",{className:"text-xs text-muted-foreground p-2 bg-gray-50 dark:bg-gray-800 rounded",children:"Coming soon..."})]})]}),e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"Scan Status"})}),e.jsxs(l,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Snyk Code"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"API Backend"})]}),e.jsx(m,{variant:"secondary",className:"text-xs",children:"Running"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Snyk Container"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Docker Images"})]}),e.jsx(m,{variant:"default",className:"text-xs",children:"Completed"})]})]})]})]})]})}),e.jsx(B,{value:"initiate-scan",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(c,{children:"Initiate New Scan"}),e.jsx(w,{children:"Select a scan type and project to begin"})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium block mb-3",children:"Scan Type"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:ne.map(s=>e.jsx("button",{onClick:()=>A(s.id),className:`p-3 border rounded-lg text-sm text-center transition-colors ${t===s.id?"bg-blue-50 dark:bg-blue-950 border-blue-500":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:s.name},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium block mb-3",children:"Project"}),e.jsxs(D,{value:p||"",onValueChange:I,children:[e.jsx(R,{className:"w-full",children:e.jsx(P,{placeholder:"Select a project..."})}),e.jsx(F,{children:_e.map(s=>e.jsx(x,{value:s.id,children:s.name},s.id))})]})]}),t&&e.jsxs(ue,{children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsxs(pe,{children:["Scan will use: ",e.jsx("strong",{children:ne.find(s=>s.id===t)?.name})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx(o,{onClick:_,disabled:N||!t||!p,children:N?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-4 h-4 mr-2 animate-spin"}),"Initiating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Start Scan"]})})})]})})]})}),e.jsx("div",{className:"lg:col-span-1 space-y-6",children:e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"Scan Information"})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"SAST - Static Code Analysis"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Analyzes source code for security vulnerabilities without executing the code."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"SCA - Software Composition Analysis"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Scans dependencies and third-party libraries for known vulnerabilities."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Container Scanning"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Analyzes Docker images and container configurations for security issues."})]})]})]})})]})}),e.jsx(B,{value:"reports",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-4",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(c,{className:"text-base",children:"Filter Reports"}),e.jsx(w,{className:"text-xs",children:"Filter by scan type, status, severity, and date range"})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium block mb-2",children:"Scan Type"}),e.jsxs(D,{value:n.scanType,onValueChange:s=>h("scanType",s),children:[e.jsx(R,{children:e.jsx(P,{placeholder:"All Types"})}),e.jsxs(F,{children:[e.jsx(x,{value:"all",children:"All Types"}),e.jsx(x,{value:"sast",children:"SAST"}),e.jsx(x,{value:"sca",children:"SCA"}),e.jsx(x,{value:"container",children:"Container"}),e.jsx(x,{value:"dast",children:"DAST"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium block mb-2",children:"Status"}),e.jsxs(D,{value:n.status,onValueChange:s=>h("status",s),children:[e.jsx(R,{children:e.jsx(P,{placeholder:"All Status"})}),e.jsxs(F,{children:[e.jsx(x,{value:"all",children:"All Status"}),e.jsx(x,{value:"completed",children:"Completed"}),e.jsx(x,{value:"scanning",children:"Scanning"}),e.jsx(x,{value:"failed",children:"Failed"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium block mb-2",children:"Severity"}),e.jsxs(D,{value:n.severity,onValueChange:s=>h("severity",s),children:[e.jsx(R,{children:e.jsx(P,{placeholder:"All Severities"})}),e.jsxs(F,{children:[e.jsx(x,{value:"all",children:"All Severities"}),e.jsx(x,{value:"critical",children:"Critical Only"}),e.jsx(x,{value:"high",children:"High+"}),e.jsx(x,{value:"medium",children:"Medium+"}),e.jsx(x,{value:"low",children:"Low+"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium block mb-2",children:"Date Range"}),e.jsxs(D,{value:n.dateRange,onValueChange:s=>h("dateRange",s),children:[e.jsx(R,{children:e.jsx(P,{placeholder:"All Time"})}),e.jsxs(F,{children:[e.jsx(x,{value:"all",children:"All Time"}),e.jsx(x,{value:"today",children:"Today"}),e.jsx(x,{value:"week",children:"This Week"}),e.jsx(x,{value:"month",children:"This Month"}),e.jsx(x,{value:"quarter",children:"This Quarter"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",H.length," of ",S.length," reports"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:Q,children:"Clear Filters"}),e.jsx(o,{size:"sm",children:"Apply Filters"})]})]}),(n.scanType!=="all"||n.status!=="all"||n.severity!=="all"||n.dateRange!=="all")&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[n.scanType!=="all"&&e.jsxs(m,{variant:"secondary",className:"text-xs",children:["Type: ",n.scanType.toUpperCase(),e.jsx("button",{onClick:()=>h("scanType","all"),className:"ml-1 hover:text-red-600",children:"×"})]}),n.status!=="all"&&e.jsxs(m,{variant:"secondary",className:"text-xs",children:["Status: ",n.status,e.jsx("button",{onClick:()=>h("status","all"),className:"ml-1 hover:text-red-600",children:"×"})]}),n.severity!=="all"&&e.jsxs(m,{variant:"secondary",className:"text-xs",children:["Severity: ",n.severity,e.jsx("button",{onClick:()=>h("severity","all"),className:"ml-1 hover:text-red-600",children:"×"})]}),n.dateRange!=="all"&&e.jsxs(m,{variant:"secondary",className:"text-xs",children:["Date: ",n.dateRange,e.jsx("button",{onClick:()=>h("dateRange","all"),className:"ml-1 hover:text-red-600",children:"×"})]})]})]})]}),e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(c,{className:"text-base",children:"Security Scan Reports"}),e.jsx(w,{className:"text-xs",children:"Comprehensive vulnerability analysis reports"})]}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(o,{variant:"outline",size:"sm",disabled:!0,className:"opacity-50 cursor-not-allowed",children:"Export All"})}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[H.length," reports available"]})]})})]}),e.jsx("div",{className:"space-y-4",children:H.map(s=>e.jsx(i,{className:"hover:shadow-md transition-shadow",children:e.jsx(l,{className:"p-6",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[s.tool," - ",s.project]}),e.jsx(m,{variant:"outline",className:"text-xs",children:s.type}),s.status==="completed"&&e.jsxs(m,{variant:"default",className:"text-xs",children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),"Completed"]}),s.status==="scanning"&&e.jsxs(m,{variant:"secondary",className:"text-xs",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),"Scanning"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scan Details"}),e.jsxs("p",{className:"text-sm",children:["Started: ",s.startTime]}),s.endTime&&e.jsxs("p",{className:"text-sm",children:["Completed: ",s.endTime]}),e.jsxs("p",{className:"text-sm",children:["Duration: ",s.duration]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vulnerability Summary"}),s.status==="completed"&&s.issues?e.jsxs("div",{className:"flex gap-2 mt-1",children:[s.issues.critical>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-red-100 dark:bg-red-950 text-red-700 dark:text-red-200 rounded",children:["Critical: ",s.issues.critical]}),s.issues.high>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-orange-100 dark:bg-orange-950 text-orange-700 dark:text-orange-200 rounded",children:["High: ",s.issues.high]}),s.issues.medium>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-yellow-100 dark:bg-yellow-950 text-yellow-700 dark:text-yellow-200 rounded",children:["Medium: ",s.issues.medium]}),s.issues.low>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-950 text-blue-700 dark:text-blue-200 rounded",children:["Low: ",s.issues.low]})]}):e.jsx("p",{className:"text-sm",children:"Scan in progress..."})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{size:"sm",onClick:()=>L(s.id),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"View Details"]}),e.jsxs(o,{variant:"outline",size:"sm",disabled:!0,className:"opacity-50 cursor-not-allowed",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Download PDF"]}),e.jsxs(o,{variant:"outline",size:"sm",disabled:!0,className:"opacity-50 cursor-not-allowed",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Re-scan"]})]})]})})})},s.id))})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"Report Statistics"})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Total Reports"}),e.jsx("span",{className:"text-sm font-medium",children:S.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Filtered Results"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:H.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"This Month"}),e.jsx("span",{className:"text-sm font-medium",children:"12"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Avg Issues"}),e.jsx("span",{className:"text-sm font-medium",children:"8.5"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Critical Total"}),e.jsx("span",{className:"text-sm font-medium text-red-600",children:"3"})]})]})]}),e.jsxs(i,{children:[e.jsx(r,{children:e.jsx(c,{className:"text-base",children:"Export Options"})}),e.jsxs(l,{className:"space-y-2",children:[e.jsx(o,{variant:"outline",size:"sm",className:"w-full justify-start opacity-50 cursor-not-allowed",disabled:!0,children:"Export All (PDF)"}),e.jsx(o,{variant:"outline",size:"sm",className:"w-full justify-start opacity-50 cursor-not-allowed",disabled:!0,children:"Export Summary (CSV)"})]})]})]})]})})]})]})]})}function Ls(){return e.jsx(Qe,{})}export{Ls as component};
