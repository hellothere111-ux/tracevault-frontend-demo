import{c as le,r as x,j as e,U as he,B as h}from"./index-oxLYDS5M.js";import{C as l,a as r,b as n,c,d as C}from"./card-DPatg_iM.js";import{B as j}from"./badge-D9o7aS9a.js";import{I as ue}from"./input-C5yHoIy3.js";import{T as re,a as ne,b as V,c as F}from"./tabs-BevVA3zn.js";import{C as $}from"./config-drawer-D_Zqf0BU.js";import{H as _,S as X}from"./search-HRcvIhH1.js";import{M as q}from"./main-Bhzi6IIr.js";import{P as Q}from"./profile-dropdown-DMX_qvN1.js";import{T as J}from"./theme-switch-COU6R3XM.js";import{T as je,a as pe,b as G,c as g,d as fe,e as N}from"./table-Bsf1k-XQ.js";import{E as ge,F as Ne,G as ve,H as be,I as ye}from"./confirm-dialog-B43sbRGH.js";import{T as ce}from"./scroll-area-BimYXtn5.js";import{T as D}from"./triangle-alert-Ds-6GkSI.js";import{C as we}from"./calendar-syglnTsf.js";import{E as K}from"./external-link-BKlmnpy9.js";import{C as W,D as ke,P as Te,a as Ce,b as Y,B as Ae,c as De}from"./PieChart-h05xZJwe.js";import{C as H}from"./circle-check-big-CTF7X7mh.js";import{C as de}from"./clock-DdRsUkfZ.js";import{C as U}from"./circle-x-CuqOFExx.js";import{A as Ie}from"./arrow-left-r_WTa7Hd.js";import{R as Z,T as ee,C as Se,X as Pe,Y as Re}from"./CartesianChart-B0t54cc_.js";import{F as se}from"./file-text-DBna068f.js";import{Z as Ve}from"./zap-CW9dCse3.js";import{E as te}from"./eye-B1F4H6XP.js";import{T as Fe}from"./trash-2-C-BuPYsj.js";import"./index-BPnUvQlg.js";import"./index-AHOSfMZ3.js";import"./index-D9L5_ghC.js";import"./index-BX0_rYSh.js";import"./index-D3MmCfGe.js";import"./index-CMoOEeul.js";import"./index-Cyo238-c.js";import"./layout-provider-diZsHGne.js";import"./rotate-ccw-BB5IJiA8.js";import"./circle-check-DunOFx40.js";import"./separator-Bq_rRqxu.js";import"./sign-out-dialog-BHgWEyYO.js";import"./check-B7Na_Hcw.js";import"./circle-question-mark-Bzm9YqMf.js";import"./arrow-right-Cr3qe1TE.js";import"./index-Cm2yHs3V.js";import"./index-BKXp8s6Q.js";import"./index-Bs3SSA5T.js";import"./graphicalItemSelectors-CE3nSQ0w.js";const Be=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],Me=le("file-check",Be);const Le=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Oe=le("upload",Le),He={Critical:"destructive",High:"destructive",Medium:"default",Low:"secondary"},Ue={Open:"destructive","In Progress":"default",Fixed:"default","Risk Accepted":"secondary"},Ee={Open:e.jsx(U,{className:"w-4 h-4"}),"In Progress":e.jsx(de,{className:"w-4 h-4"}),Fixed:e.jsx(H,{className:"w-4 h-4"}),"Risk Accepted":e.jsx(D,{className:"w-4 h-4"})};function ze({vulnerability:a,isOpen:p,onClose:k}){const[v,b]=x.useState(!1),y=i=>{navigator.clipboard.writeText(i),b(!0),setTimeout(()=>b(!1),2e3)},w=i=>e.jsx(j,{variant:He[i]||"secondary",children:i}),f=i=>e.jsxs(j,{variant:Ue[i]||"secondary",className:"flex items-center gap-1",children:[Ee[i],i]});return a?e.jsx(ge,{open:p,onOpenChange:k,children:e.jsxs(Ne,{className:"w-screen max-h-[90vh] overflow-y-auto",children:[e.jsxs(ve,{children:[e.jsx(be,{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[w(a.severity),f(a.status)]}),e.jsx("h2",{className:"text-xl font-bold",children:a.title}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono mt-1",children:a.vulnerabilityId})]})}),e.jsx(ye,{children:"Detailed vulnerability information and remediation guidance"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(l,{children:[e.jsx(r,{className:"pb-3",children:e.jsxs(n,{className:"text-base flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"Target Information"]})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Target:"}),e.jsx("span",{className:"text-sm",children:a.target})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Branch:"}),e.jsx("span",{className:"text-sm font-mono",children:a.targetedBranch})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Instances:"}),e.jsx("span",{className:"text-sm",children:a.instances})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Assessment Type:"}),e.jsx("span",{className:"text-sm",children:a.assessmentType})]})]})]}),e.jsxs(l,{children:[e.jsx(r,{className:"pb-3",children:e.jsxs(n,{className:"text-base flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"Responsibility & Status"]})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Responsible Team:"}),e.jsx("span",{className:"text-sm",children:a.responsibleTeam})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Current Status:"}),f(a.status)]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Risk Level:"}),e.jsx("span",{className:"text-sm",children:a.risk})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Risk Accepted:"}),e.jsx("span",{className:"text-sm",children:a.riskAcceptance?"Yes":"No"})]})]})]}),e.jsxs(l,{children:[e.jsx(r,{className:"pb-3",children:e.jsxs(n,{className:"text-base flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Assessment Details"]})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"CVE ID:"}),e.jsx("span",{className:"text-sm font-mono",children:a.cveId||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Severity:"}),w(a.severity)]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Source:"}),e.jsx("span",{className:"text-sm",children:a.source})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Category:"}),e.jsx("span",{className:"text-sm",children:a.category})]})]})]})]}),e.jsxs(l,{children:[e.jsx(r,{children:e.jsx(n,{className:"text-base",children:"Vulnerability Details"})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:a.description})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Category"}),e.jsx(j,{variant:"outline",children:a.category})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Recommendation"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed bg-blue-50 dark:bg-blue-950 p-3 rounded-lg",children:a.recommendation})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Remarks"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:a.remarks})]})]})]}),e.jsxs(l,{children:[e.jsx(r,{children:e.jsxs(n,{className:"text-base flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"Timeline Information"]})}),e.jsx(c,{className:"space-y-3",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Discovery Date:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Fix Date:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.fixDate||"Not fixed yet"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Assessment Type:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.assessmentType})]})]})})]}),e.jsxs(l,{children:[e.jsx(r,{children:e.jsx(n,{className:"text-base",children:"References"})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"CVE ID:"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-sm font-mono text-muted-foreground",children:a.cveId||"No CVE assigned"}),a.cveId&&e.jsx(h,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>window.open(a.reference,"_blank"),children:e.jsx(K,{className:"w-3 h-3"})}),e.jsx(h,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>y(a.cveId||a.vulnerabilityId),children:e.jsx(W,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Additional Reference:"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground truncate",children:a.reference}),e.jsx(h,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>window.open(a.reference,"_blank"),children:e.jsx(K,{className:"w-3 h-3"})}),e.jsx(h,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>y(a.reference),children:e.jsx(W,{className:"w-3 h-3"})})]})]}),v&&e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400",children:"Copied to clipboard!"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(h,{variant:"outline",onClick:k,children:"Close"}),e.jsx(h,{children:"Create Jira Ticket"})]})]})]})}):null}const m=[{id:1,date:"2024-01-18",vulnerabilityId:"VULN-001",cveId:"CVE-2024-1234",instances:3,assessmentType:"Quarterly",target:"API Backend",title:"SQL Injection in Authentication Module",severity:"Critical",targetedBranch:"main",category:"Injection",description:"SQL injection vulnerability found in the authentication endpoint allowing unauthorized access to user data.",risk:"High",recommendation:"Implement parameterized queries and input validation in all database operations.",responsibleTeam:"Backend Team",status:"Open",source:"Manual Penetration Test",fixDate:null,riskAcceptance:!1,remarks:"Requires immediate attention as it affects production data.",reference:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1234"},{id:2,date:"2024-01-18",vulnerabilityId:"VULN-002",cveId:"CVE-2024-5678",instances:1,assessmentType:"Adhoc",target:"Frontend App",title:"Cross-Site Scripting (XSS)",severity:"High",targetedBranch:"develop",category:"XSS",description:"Reflected XSS vulnerability in the search functionality allowing script execution.",risk:"Medium",recommendation:"Implement proper output encoding and Content Security Policy.",responsibleTeam:"Frontend Team",status:"In Progress",source:"Automated Scanner",fixDate:"2024-01-25",riskAcceptance:!1,remarks:"Fix being implemented in current sprint.",reference:"OWASP Top 10 A03:2021"},{id:3,date:"2024-01-17",vulnerabilityId:"VULN-003",cveId:null,instances:5,assessmentType:"Annual",target:"Mobile App",title:"Weak Password Policy",severity:"Medium",targetedBranch:"release",category:"Authentication",description:"Password policy does not enforce complexity requirements.",risk:"Low",recommendation:"Implement strong password policy with minimum 8 characters, uppercase, lowercase, numbers, and special characters.",responsibleTeam:"Mobile Team",status:"Fixed",source:"Manual Review",fixDate:"2024-01-20",riskAcceptance:!1,remarks:"Password policy updated and deployed to production.",reference:"NIST SP 800-63B"},{id:4,date:"2024-01-16",vulnerabilityId:"VULN-004",cveId:null,instances:2,assessmentType:"Quarterly",target:"Service Worker",title:"Information Disclosure",severity:"Low",targetedBranch:"main",category:"Information Disclosure",description:"Sensitive information exposed in error messages.",risk:"Low",recommendation:"Implement generic error messages and sanitize error outputs.",responsibleTeam:"DevOps Team",status:"Risk Accepted",source:"Manual Penetration Test",fixDate:null,riskAcceptance:!0,remarks:"Risk accepted due to low impact and high remediation cost.",reference:"Internal security guidelines"}],P={Critical:"#dc2626",High:"#ea580c",Medium:"#ca8a04",Low:"#2563eb"},R={Open:"#dc2626","In Progress":"#ca8a04",Fixed:"#16a34a","Risk Accepted":"#6b7280"};function $e({reportId:a,onBack:p}){const[k,v]=x.useState("overview"),[b,y]=x.useState(null),[w,f]=x.useState(!1),i={total:m.length,critical:m.filter(t=>t.severity==="Critical").length,high:m.filter(t=>t.severity==="High").length,medium:m.filter(t=>t.severity==="Medium").length,low:m.filter(t=>t.severity==="Low").length,open:m.filter(t=>t.status==="Open").length,inProgress:m.filter(t=>t.status==="In Progress").length,fixed:m.filter(t=>t.status==="Fixed").length,riskAccepted:m.filter(t=>t.status==="Risk Accepted").length},I=[{name:"Critical",value:i.critical,color:P.Critical},{name:"High",value:i.high,color:P.High},{name:"Medium",value:i.medium,color:P.Medium},{name:"Low",value:i.low,color:P.Low}],S=[{name:"Open",value:i.open,color:R.Open},{name:"In Progress",value:i.inProgress,color:R["In Progress"]},{name:"Fixed",value:i.fixed,color:R.Fixed},{name:"Risk Accepted",value:i.riskAccepted,color:R["Risk Accepted"]}],B=t=>{const o={Critical:"destructive",High:"destructive",Medium:"default",Low:"secondary"};return e.jsx(j,{variant:o[t]||"secondary",children:t})},M=t=>{const o={Open:"destructive","In Progress":"default",Fixed:"default","Risk Accepted":"secondary"},O={Open:e.jsx(U,{className:"w-3 h-3"}),"In Progress":e.jsx(de,{className:"w-3 h-3"}),Fixed:e.jsx(H,{className:"w-3 h-3"}),"Risk Accepted":e.jsx(D,{className:"w-3 h-3"})};return e.jsxs(j,{variant:o[t]||"secondary",className:"flex items-center gap-1",children:[O[t],t]})},L=t=>{y(t),f(!0)};return e.jsxs("div",{className:"space-y-6 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(h,{variant:"ghost",onClick:p,className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"}),"Back to Reports"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Vulnerability Report Details"}),e.jsxs("p",{className:"text-muted-foreground",children:["Report ID: ",a]})]})]}),e.jsxs(h,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"}),"Export Report"]})]}),e.jsxs(re,{value:k,onValueChange:v,children:[e.jsxs(ne,{className:"grid w-full grid-cols-2",children:[e.jsx(V,{value:"overview",children:"Overview"}),e.jsx(V,{value:"vulnerabilities",children:"Vulnerabilities"})]}),e.jsxs(F,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Total Vulnerabilities"}),e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all targets"})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Critical Issues"}),e.jsx(D,{className:"h-4 w-4 text-destructive"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:i.critical}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Require immediate attention"})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Fixed Issues"}),e.jsx(H,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.fixed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully resolved"})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Open Issues"}),e.jsx(U,{className:"h-4 w-4 text-destructive"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:i.open}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending resolution"})]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(n,{children:"Severity Distribution"}),e.jsx(C,{children:"Breakdown by vulnerability severity"})]}),e.jsx(c,{children:e.jsx(Z,{width:"100%",height:300,children:e.jsxs(Te,{children:[e.jsx(Ce,{data:I,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:o})=>`${t} ${((o||0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:I.map((t,o)=>e.jsx(Y,{fill:t.color},`cell-${o}`))}),e.jsx(ee,{})]})})})]}),e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(n,{children:"Status Overview"}),e.jsx(C,{children:"Current status of all vulnerabilities"})]}),e.jsx(c,{children:e.jsx(Z,{width:"100%",height:300,children:e.jsxs(Ae,{data:S,children:[e.jsx(Se,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"name"}),e.jsx(Re,{}),e.jsx(ee,{}),e.jsx(De,{dataKey:"value",fill:"#8884d8",children:S.map((t,o)=>e.jsx(Y,{fill:t.color},`cell-${o}`))})]})})})]})]})]}),e.jsx(F,{value:"vulnerabilities",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(n,{children:"Vulnerability Details"}),e.jsx(C,{children:"Complete list of identified vulnerabilities"})]}),e.jsx(c,{children:e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs(je,{children:[e.jsx(pe,{children:e.jsxs(G,{children:[e.jsx(g,{children:"ID"}),e.jsx(g,{children:"Date"}),e.jsx(g,{children:"Title"}),e.jsx(g,{children:"Severity"}),e.jsx(g,{children:"Status"}),e.jsx(g,{children:"Target"}),e.jsx(g,{children:"Team"}),e.jsx(g,{children:"Actions"})]})}),e.jsx(fe,{children:m.map(t=>e.jsxs(G,{children:[e.jsx(N,{className:"font-mono text-xs",children:t.vulnerabilityId}),e.jsx(N,{className:"text-xs",children:t.date}),e.jsx(N,{className:"max-w-xs truncate",title:t.title,children:t.title}),e.jsx(N,{children:B(t.severity)}),e.jsx(N,{children:M(t.status)}),e.jsx(N,{className:"text-xs",children:t.target}),e.jsx(N,{className:"text-xs",children:t.responsibleTeam}),e.jsx(N,{children:e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>L(t),children:"View Details"})})]},t.id))})]})})})]})})]}),e.jsx(ze,{vulnerability:b,isOpen:w,onClose:()=>f(!1)})]})}const ae=[{id:"all",label:"All Projects",type:"all"},{id:"axion-platform",label:"Axion Platform",type:"project"},{id:"payment-gateway",label:"Payment Gateway",type:"project"},{id:"auth-service",label:"Auth Service",type:"project"},{id:"api-service",label:"API Service",type:"project"},{id:"mobile-backend",label:"Mobile Backend",type:"project"}],ie=[{id:"VAPT-001",name:"Q1 2024 - External Penetration Test",uploadDate:"2024-01-18",uploadedBy:"John Smith",status:"processed",findings:15,critical:2,high:5,medium:6,low:2,jiraTickets:13,project:"axion-platform"},{id:"VAPT-002",name:"Internal Network Assessment",uploadDate:"2024-01-15",uploadedBy:"Sarah Johnson",status:"processed",findings:8,critical:0,high:2,medium:4,low:2,jiraTickets:8,project:"payment-gateway"},{id:"VAPT-003",name:"API Security Assessment",uploadDate:"2024-01-10",uploadedBy:"Mike Chen",status:"processing",findings:null,critical:null,high:null,medium:null,low:null,jiraTickets:null,project:"api-service"},{id:"VAPT-004",name:"Auth Service Security Audit",uploadDate:"2024-01-08",uploadedBy:"John Smith",status:"processed",findings:6,critical:1,high:2,medium:2,low:1,jiraTickets:6,project:"auth-service"}];function _e(){const[a,p]=x.useState([]),[k,v]=x.useState(!1),[b,y]=x.useState(!1),[w,f]=x.useState(null),[i,I]=x.useState("all"),[S,B]=x.useState("overview"),M=s=>{s.preventDefault(),v(!0)},L=()=>{v(!1)},t=s=>{s.preventDefault(),v(!1);const d=Array.from(s.dataTransfer.files);p(z=>[...z,...d])},o=s=>{s.target.files&&p(d=>[...d,...Array.from(s.target.files)])},O=async()=>{if(!a.length){alert("Please select files to upload");return}y(!0),await new Promise(s=>setTimeout(s,2e3)),y(!1),alert(`Uploaded ${a.length} file(s) successfully`),p([])},oe=s=>{p(d=>d.filter((z,xe)=>xe!==s))},E=s=>{f(s)},me=()=>{f(null)},A=()=>i==="all"?ie:ie.filter(s=>s.project===i),u=A(),T={totalReports:u.length,processedReports:u.filter(s=>s.status==="processed").length,totalFindings:u.reduce((s,d)=>s+(d.findings||0),0),criticalIssues:u.reduce((s,d)=>s+(d.critical||0),0),highIssues:u.reduce((s,d)=>s+(d.high||0),0),remediationTasks:u.reduce((s,d)=>s+(d.jiraTickets||0),0),jiraTickets:u.reduce((s,d)=>s+(d.jiraTickets||0),0),vaptAssessmentsConducted:i==="all"?12:Math.floor(Math.random()*4)+1,avgSecurityAssessmentTime:i==="all"?"3.8 days":Math.floor(Math.random()*5)+2+" days",lastAssessmentDate:u.length>0?u[0].uploadDate:"N/A"};return w?e.jsxs(e.Fragment,{children:[e.jsxs(_,{fixed:!0,children:[e.jsx(X,{}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(J,{}),e.jsx($,{}),e.jsx(Q,{})]})]}),e.jsx(q,{className:"flex flex-1 flex-col gap-6 w-full",children:e.jsx($e,{reportId:w,onBack:me})})]}):(ae.find(s=>s.id===i),e.jsxs(e.Fragment,{children:[e.jsxs(_,{fixed:!0,children:[e.jsx(X,{}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(J,{}),e.jsx($,{}),e.jsx(Q,{})]})]}),e.jsxs(q,{className:"flex flex-1 flex-col gap-4 sm:gap-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Red Team / VAPT Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Upload manual penetration testing reports and automatically create tasks"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Project"}),e.jsx("select",{value:i,onChange:s=>I(s.target.value),className:"px-3 py-2 rounded-md border border-input bg-background text-sm",children:ae.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-4",children:[e.jsx("div",{className:"lg:col-span-3 space-y-6",children:e.jsxs(re,{value:S,onValueChange:B,children:[e.jsxs(ne,{children:[e.jsx(V,{value:"overview",children:"Overview"}),e.jsx(V,{value:"reports",children:"Reports"})]}),e.jsxs(F,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Total Reports"}),e.jsx(se,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:T.totalReports}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"VAPT assessments uploaded"})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Issues Found"}),e.jsx(D,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:T.totalFindings}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total vulnerabilities"})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Remediation Tasks"}),e.jsx(Ve,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:T.remediationTasks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Created tickets"})]})]}),e.jsxs(l,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"VAPT Assessments"}),e.jsx(Me,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:T.vaptAssessmentsConducted}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Times tested manually"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(l,{children:[e.jsx(r,{children:e.jsx(n,{className:"text-base",children:"Avg Security Assessment Time"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold",children:T.avgSecurityAssessmentTime}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Average assessment duration"})]})]}),e.jsxs(l,{children:[e.jsx(r,{children:e.jsx(n,{className:"text-base",children:"Last Assessment Date"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-lg font-bold",children:T.lastAssessmentDate}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Most recent assessment"})]})]})]}),e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(n,{className:"text-base",children:"Recent Reports"}),e.jsx(C,{className:"text-xs",children:"Latest VAPT assessments"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:A().length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No reports found for the selected project."})}):A().slice(0,3).map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent transition-colors cursor-pointer",onClick:()=>E(s.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:s.name}),s.status==="processing"&&e.jsx(j,{variant:"secondary",className:"text-xs",children:"Processing"}),s.status==="processed"&&e.jsx(j,{variant:"outline",className:"text-xs",children:"Processed"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Uploaded by ",s.uploadedBy," on ",s.uploadDate]})]}),e.jsx(te,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]}),s.status==="processed"&&s.findings&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-1 text-xs font-medium mb-3",children:[s.critical&&s.critical>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-200 rounded",children:["C:",s.critical]}),s.high&&s.high>0&&e.jsxs("span",{className:"px-2 py-1 bg-orange-100 dark:bg-orange-900 text-orange-700 dark:text-orange-200 rounded",children:["H:",s.high]}),s.medium&&s.medium>0&&e.jsxs("span",{className:"px-2 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-200 rounded",children:["M:",s.medium]}),s.low&&s.low>0&&e.jsxs("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200 rounded",children:["L:",s.low]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.findings," findings • ",s.jiraTickets," tickets created"]})]}),s.status==="processing"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400",children:[e.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}),"Processing PDF and extracting findings..."]})]},s.id))})})]})]}),e.jsx(F,{value:"reports",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(n,{className:"text-base",children:"All Reports"}),e.jsx(C,{className:"text-xs",children:"Click to view detailed vulnerability analysis"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:A().length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No reports found for the selected project."})}):A().map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent transition-colors cursor-pointer",onClick:()=>E(s.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:s.name}),s.status==="processing"&&e.jsx(j,{variant:"secondary",className:"text-xs",children:"Processing"}),s.status==="processed"&&e.jsx(j,{variant:"outline",className:"text-xs",children:"Processed"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Uploaded by ",s.uploadedBy," on ",s.uploadDate]})]}),e.jsx(te,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]}),s.status==="processed"&&s.findings&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-1 text-xs font-medium mb-3",children:[s.critical&&s.critical>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-200 rounded",children:["C:",s.critical]}),s.high&&s.high>0&&e.jsxs("span",{className:"px-2 py-1 bg-orange-100 dark:bg-orange-900 text-orange-700 dark:text-orange-200 rounded",children:["H:",s.high]}),s.medium&&s.medium>0&&e.jsxs("span",{className:"px-2 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-200 rounded",children:["M:",s.medium]}),s.low&&s.low>0&&e.jsxs("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200 rounded",children:["L:",s.low]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.findings," findings • ",s.jiraTickets," tickets created"]})]}),s.status==="processing"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400",children:[e.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}),"Processing PDF and extracting findings..."]})]},s.id))})})]})})]})}),e.jsx("div",{className:"lg:col-span-1 space-y-6",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(n,{className:"text-base",children:"Upload VAPT Report"}),e.jsx(C,{className:"text-xs",children:"PDF or Excel format"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{onDragOver:M,onDragLeave:L,onDrop:t,className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ${k?"border-blue-500 bg-blue-50 dark:bg-blue-950":"border-gray-300 dark:border-gray-600 hover:border-gray-400"}`,children:[e.jsx(Oe,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium",children:"Drag files here or click to browse"}),e.jsx(ue,{type:"file",multiple:!0,accept:".pdf,.xlsx,.xls",onChange:o,className:"hidden",id:"file-input"}),e.jsx("label",{htmlFor:"file-input",className:"cursor-pointer",children:e.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Click to select"})})]}),a.length>0&&e.jsx("div",{className:"space-y-2",children:a.map((s,d)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-900 rounded text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx(se,{className:"w-4 h-4 flex-shrink-0 text-blue-600"}),e.jsx("span",{className:"truncate",children:s.name})]}),e.jsx("button",{onClick:()=>oe(d),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-800 rounded",children:e.jsx(Fe,{className:"w-4 h-4 text-red-600"})})]},d))}),e.jsx(h,{onClick:O,disabled:b||!a.length,className:"w-full",children:b?"Uploading...":"Upload & Process"})]})]})})]})]})]}))}function Ms(){return e.jsx(_e,{})}export{Ms as component};
